parameters:
    env(FLAG_DATA_QUALITY_INSIGHTS_ENABLED): 'true'

services:
    akeneo.pim.automation.data_quality_insights.feature:
        class: Akeneo\Platform\Bundle\FeatureFlagBundle\Configuration\EnvVarFeatureFlag
        arguments:
            - '%env(bool:FLAG_DATA_QUALITY_INSIGHTS_ENABLED)%'
        public: true

    akeneo.pim.automation.data_quality_insights.all_criteria.feature:
        class: Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\FeatureFlag\AllCriteriaFeature
        arguments:
            - '@akeneo.feature_flag.service.only_enterprise_edition_feature'
            - '@feature_flags'

    # TODO: move this file
    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Handler\LaunchProductAndProductModelEvaluationsHandler:
        tags:
            - name: 'akeneo.message_handler'
              consumer: 'dqi_launch_product_and_product_model_evaluations_consumer'
#        tags:
#            - name: 'messenger.message_handler'
#              handles: 'Akeneo\Pim\Automation\DataQualityInsights\Domain\Message\LaunchProductAndProductModelEvaluationsMessage'
#              from_transport: dqi_launch_product_and_product_model_evaluations_consumer

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Handler\SecondHandler:
        tags:
            -   name: 'akeneo.message_handler'
                consumer: 'second_consumer_for_tests'
#        tags:
#            - name: 'messenger.message_handler'
#              handles: 'Akeneo\Pim\Automation\DataQualityInsights\Domain\Message\LaunchProductAndProductModelEvaluationsMessage'
#              from_transport: second_consumer_for_tests
