parameters:
    akeneo_integration_tests.elasticsearch_index_names:
        - '%product_and_product_model_index_name%'
        - '%connection_error_index_name%'
        - '%product_proposal_index_name%'
        - '%published_product_index_name%'
        - '%asset_index_name%'
        - '%record_index_name%'

services:
    akeneo_integration_tests.loader.reference_data_loader:
        class: '%akeneo_integration_tests.loader.reference_data_loader.class%'
        arguments:
            - '@doctrine.orm.entity_manager'
            - '%kernel.bundles%'
            - 'AcmeEnterpriseAppBundle'
            - 'AcmeEnterprise\Bundle\AppBundle\Entity\Fabric'
            - 'AcmeEnterprise\Bundle\AppBundle\Entity\Color'

    akeneo_ee_integration_tests.loader.fixtures_loader:
        class: 'AkeneoEnterprise\Test\IntegrationTestsBundle\Loader\FixturesLoader'
        decorates: 'akeneo_integration_tests.loader.fixtures_loader'
        decoration_inner_name: 'akeneo_integration_tests.loader.fixtures_loader.base'
        arguments:
            - '@akeneo_integration_tests.loader.fixtures_loader.base'
            - '@akeneo_ee_integration_tests.loader.permission_cleaner'

    akeneo_ee_integration_tests.loader.permission_cleaner:
        class: 'AkeneoEnterprise\Test\IntegrationTestsBundle\Loader\PermissionCleaner'
        arguments:
            - '@database_connection'

    akeneo_integration_tests.catalogs_enterprise:
        class: 'AkeneoEnterprise\Test\IntegrationTestsBundle\Configuration\Catalog'
        decorates: 'akeneo_integration_tests.catalogs'
        arguments:
            - '@akeneo_integration_tests.catalogs_enterprise.inner'

    akeneo_ee_integration_tests.builder.attribute:
        class: 'Akeneo\Test\Common\EntityBuilder'
        shared: false
        arguments:
            - '@pim_catalog.factory.attribute'
            - '@pim_catalog.updater.attribute'
            - '@validator'

    akeneo_ee_integration_tests.builder.family:
        class: 'Akeneo\Test\Common\EntityBuilder'
        shared: false
        arguments:
            - '@pim_catalog.factory.family'
            - '@pim_catalog.updater.family'
            - '@validator'

    akeneo_integration_tests.loader.category_tree_loader_with_permissions:
        class: 'AkeneoTestEnterprise\Pim\Permission\Integration\Enrichment\Storage\ElasticsearchAndSql\CategoryTree\CategoryTreeFixturesLoaderWithPermission'
        arguments:
            - '@pim_user.repository.user'
            - '@pim_user.repository.group'
            - '@validator'
            - '@pim_user.saver.user'
            - '@pimee_security.manager.category_access'
            - '@doctrine.orm.default_entity_manager'
            - '@pim_catalog.factory.category'
            - '@pim_catalog.updater.category'
            - '@pim_catalog.saver.category'
            - '@pim_catalog.builder.product'
            - '@pim_catalog.updater.product'
            - '@pim_catalog.validator.product'
            - '@pim_catalog.saver.product'
            - '@pim_catalog.factory.family'
            - '@pim_catalog.updater.family'
            - '@pim_catalog.saver.family'
            - '@pim_catalog.factory.family_variant'
            - '@pim_catalog.updater.family_variant'
            - '@pim_catalog.saver.family_variant'
            - '@pim_catalog.factory.attribute'
            - '@pim_catalog.updater.attribute'
            - '@pim_catalog.saver.attribute'
            - '@pim_catalog.factory.product_model'
            - '@pim_catalog.updater.product_model'
            - '@pim_catalog.saver.product_model'
            - '@pim_catalog.repository.product_category'
            - '@akeneo_elasticsearch.client.product_and_product_model'

    akeneo_integration_tests.loader.permissions:
        class: 'AkeneoTestEnterprise\Pim\Permission\EndToEnd\API\PermissionFixturesLoader'
        arguments:
            - '@pim_catalog.factory.attribute'
            - '@pim_catalog.updater.attribute'
            - '@pim_catalog.saver.attribute'
            - '@pim_catalog.factory.family'
            - '@pim_catalog.updater.family'
            - '@pim_catalog.saver.family'
            - '@pim_catalog.factory.family_variant'
            - '@pim_catalog.updater.family_variant'
            - '@pim_catalog.saver.family_variant'
            - '@pim_catalog.builder.product'
            - '@pim_catalog.updater.product'
            - '@pim_catalog.validator.product'
            - '@pim_catalog.saver.product'
            - '@pim_catalog.factory.product_model'
            - '@pim_catalog.updater.product_model'
            - '@pim_catalog.saver.product_model'
            - '@pim_catalog.factory.category'
            - '@pim_catalog.updater.category'
            - '@pim_catalog.saver.category'
            - '@pimee_security.manager.category_access'
            - '@doctrine.orm.default_entity_manager'
            - '@akeneo_elasticsearch.client.product_and_product_model'
            - '@validator'

    akeneo_integration_tests.event_dispatcher:
        class: 'AkeneoEnterprise\Test\IntegrationTestsBundle\EventDispatcher\EventDispatcherMock'
        decorates: event_dispatcher
        arguments:
            - '@akeneo_integration_tests.event_dispatcher.inner'

    akeneo_integration_tests.helper.authenticator:
        class: 'AkeneoEnterprise\Test\IntegrationTestsBundle\Helper\AuthenticatorHelper'
        arguments:
            - '@pim_user.repository.user'
            - '@pim_user.factory.user'
            - '@pim_user.saver.user'
            - '@pim_user.repository.group'
            - '@pim_user.repository.role'
            - '@security.token_storage'
            - '@session'

    akeneo_integration_tests.helper.web_client:
        class: 'AkeneoEnterprise\Test\IntegrationTestsBundle\Helper\WebClientHelper'
        arguments:
            - '@router'

    akeneo_monitoring.status_checker.pub_sub:
        class: 'Akeneo\Platform\Bundle\MonitoringBundle\ServiceStatusChecker\PubSub\NullPubSubStatusChecker'
