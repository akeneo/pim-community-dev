parameters:
    pimee_workflow.controller.external_api.product_draft.class: PimEnterprise\Bundle\WorkflowBundle\Controller\Api\ProductDraftController
    pimee_workflow.controller.external_api.product_proposal.class: PimEnterprise\Bundle\WorkflowBundle\Controller\Api\ProductProposalController
    pimee_api.router.proxy_product.class: PimEnterprise\Bundle\WorkflowBundle\Router\ProxyProductRouter
    pimee_api.normalizer.product.class: PimEnterprise\Component\Workflow\Normalizer\ExternalApi\ProductNormalizer

services:
    # Controllers
    pimee_workflow.controller.external_api.product_proposal:
        class : '%pimee_workflow.controller.external_api.product_proposal.class%'
        arguments:
            - '@pim_api.repository.product'
            - '@pimee_workflow.repository.product_draft'
            - '@pimee_workflow.manager.product_draft'
            - '@security.token_storage'
            - '@security.authorization_checker'

    pimee_workflow.controller.external_api.product_draft:
        class: '%pimee_workflow.controller.external_api.product_draft.class%'
        arguments:
            - '@pim_api.repository.product'
            - '@pimee_workflow.repository.product_draft'
            - '@pimee_workflow.applier.product_draft'
            - '@pim_serializer'
            - '@security.token_storage'
            - '@security.authorization_checker'

    # URL generator
    pimee_api.router.proxy_product:
        class: '%pimee_api.router.proxy_product.class%'
        arguments:
            - '@router'
            - '@security.token_storage'
            - '@pimee_workflow.repository.product_draft'
            - '@pim_api.repository.product'
            - 'pimee_api_product_draft_get'

    # Normalizer
    pimee_api.normalizer.product:
        class: '%pimee_api.normalizer.product.class%'
        decorates: pim_api.normalizer.product
        decoration_inner_name: pim_api.normalizer.product.community
        arguments:
            - '@pim_api.normalizer.product.community'
            - '@pimee_workflow.repository.product_draft'
            - '@security.authorization_checker'
            - '@security.token_storage'