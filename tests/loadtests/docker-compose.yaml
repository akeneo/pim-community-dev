version: '3.7'

services:
  k6:
    image: 'grafana/k6'
    environment:
      FQDN: '${FQDN:-localhost:8080}'
      SECURE: ${SECURE:-1}
      API_CLIENT_ID: '${API_CLIENT_ID:-mock-api-client-id}'
      API_SECRET: '${API_SECRET:-mock-api-secret}'
      API_USERNAME: '${API_USERNAME:-mock-api-username}'
      API_PASSWORD: '${API_PASSWORD:-mock-api-password}'
      K6_DURATION: '${K6_DURATION:-10s}'
      K6_VUS: '${K6_VUS:-10}'
    command: 'run /srv/k6/${COMMAND:-crud-products}.js'
    volumes:
      - './:/srv/k6'
    ####################################################
    # Uncomment following lines to target localhost pim#
    # And set SECURE environment var to 0 to use http  #
    ####################################################
    network_mode: host
