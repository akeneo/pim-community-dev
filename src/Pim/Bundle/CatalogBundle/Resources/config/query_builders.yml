parameters:
    pim_catalog.query.product_query_builder_factory.class:      Pim\Component\Catalog\Query\ProductQueryBuilderFactory
    pim_catalog.query.product_query_builder.class:              Pim\Component\Catalog\Query\ProductQueryBuilder
    pim_catalog.query.filter.registry.class:                    Pim\Component\Catalog\Query\Filter\FilterRegistry
    pim_catalog.query.sorter.registry.class:                    Pim\Component\Catalog\Query\Sorter\SorterRegistry
    pim_catalog.query.filter.field_dumper.class:                Pim\Bundle\CatalogBundle\Command\ProductQueryHelp\FieldFilterDumper
    pim_catalog.query.filter.attribute_dumper.class:            Pim\Bundle\CatalogBundle\Command\ProductQueryHelp\AttributeFilterDumper
    pim_catalog.doctrine.query.filter.object_id_resolver.class: Pim\Bundle\CatalogBundle\Doctrine\Common\Filter\ObjectIdResolver
    pim_catalog.doctrine.query.filter.object_code_resolver.class: Pim\Bundle\CatalogBundle\Doctrine\Common\Filter\ObjectCodeResolver

services:
    pim_catalog.query.product_query_builder_factory:
        class: '%pim_catalog.query.product_query_builder_factory.class%'
        arguments:
            - '%pim_catalog.query.product_query_builder.class%'
            - '@pim_catalog.object_manager.product'
            - '%pim_catalog.entity.product.class%'
            - '@pim_catalog.repository.attribute'
            - '@pim_catalog.query.filter.registry'
            - '@pim_catalog.query.sorter.registry'
            - '@pim_catalog.factory.product_cursor'

    pim_catalog.query.filter.registry:
        class: '%pim_catalog.query.filter.registry.class%'
        arguments:
            - '@pim_catalog.repository.attribute'

    pim_catalog.query.sorter.registry:
        class: '%pim_catalog.query.sorter.registry.class%'

    pim_catalog.query.filter.field_dumper:
        class: '%pim_catalog.query.filter.field_dumper.class%'
        arguments:
            - '@pim_catalog.query.filter.registry'

    pim_catalog.query.filter.attribute_dumper:
        class: '%pim_catalog.query.filter.attribute_dumper.class%'
        arguments:
            - '@pim_catalog.query.filter.registry'
            - '@pim_catalog.repository.attribute'

    # PQB common utils
    pim_catalog.doctrine.query.filter.object_id_resolver:
        class: '%pim_catalog.doctrine.query.filter.object_id_resolver.class%'
        arguments:
            - '@akeneo_storage_utils.doctrine.smart_manager_registry'
        calls:
            - [ addFieldMapping, ['family', '%pim_catalog.entity.family.class%']]
            - [ addFieldMapping, ['option', '%pim_catalog.entity.attribute_option.class%']]
            - [ addFieldMapping, ['category', '%pim_catalog.entity.category.class%']]
            - [ addFieldMapping, ['group', '%pim_catalog.entity.group.class%']]

    pim_catalog.doctrine.query.filter.object_code_resolver:
        class: '%pim_catalog.doctrine.query.filter.object_code_resolver.class%'
        arguments:
            - '@akeneo_storage_utils.doctrine.smart_manager_registry'
        calls:
            - [ addFieldMapping, ['family', '%pim_catalog.entity.family.class%']]
            - [ addFieldMapping, ['option', '%pim_catalog.entity.attribute_option.class%']]
            - [ addFieldMapping, ['category', '%pim_catalog.entity.category.class%']]
            - [ addFieldMapping, ['group', '%pim_catalog.entity.group.class%']]
