parameters:
    pimee_versioning.normalizer.category.class:        Akeneo\Pim\Permission\Bundle\Normalizer\Flat\CategoryNormalizer
    pimee_versioning.normalizer.attribute_group.class: Akeneo\Pim\Permission\Bundle\Normalizer\Flat\AttributeGroupNormalizer
    pimee_versioning.normalizer.locale.class:          Akeneo\Pim\Permission\Bundle\Normalizer\Flat\LocaleNormalizer
    pimee_security.normalizer.job_instance.class:      Akeneo\Pim\Permission\Component\Normalizer\Standard\JobInstanceNormalizer
    pimee_security.normalizer.attribute_group.class:   Akeneo\Pim\Permission\Component\Normalizer\Standard\AttributeGroupNormalizer
    pimee_security.normalizer.authorization.product.class: Akeneo\Pim\Permission\Component\Normalizer\Authorization\ProductNormalizer
    pimee_security.normalizer.authorization.product_model.class: Akeneo\Pim\Permission\Component\Normalizer\Authorization\ProductModelNormalizer

    # Encoders
    pimee_authorization_serializer.encoder.json.class: Symfony\Component\Serializer\Encoder\JsonEncoder

services:
    pimee_enrich.serializer.normalizer.granted_family:
        parent: pim_catalog.normalizer.standard.family
        tags:
            - { name: pim_internal_api_serializer.normalizer, priority: 100 }

    pimee_versioning.normalizer.category:
        class: '%pimee_versioning.normalizer.category.class%'
        arguments:
            - '@pim_versioning.serializer.normalizer.flat.category'
            - '@pimee_security.manager.category_access'
        tags:
            - { name: pim_versioning.serializer.normalizer, priority: 100 }

    pimee_versioning.normalizer.attribute_group:
        class: '%pimee_versioning.normalizer.attribute_group.class%'
        arguments:
            - '@pim_versioning.serializer.normalizer.flat.attribute_group'
            - '@pimee_security.manager.attribute_group_access'
        tags:
            - { name: pim_versioning.serializer.normalizer, priority: 100 }

    pimee_versioning.normalizer.locale:
        class: '%pimee_versioning.normalizer.locale.class%'
        arguments:
            - '@pim_versioning.serializer.normalizer.flat.locale'
            - '@pimee_security.manager.locale_access'
        tags:
            - { name: pim_versioning.serializer.normalizer, priority: 100 }

    pimee_security.normalizer.job_instance:
        class: '%pimee_security.normalizer.job_instance.class%'
        arguments:
            - '@pim_catalog.normalizer.standard.job_instance'
            - '@pimee_security.manager.job_profile_access'
        tags:
            - { name: pim_standard_format_serializer.normalizer, priority: 110 }

    pimee_security.normalizer.attribute_group:
        class: '%pimee_security.normalizer.attribute_group.class%'
        arguments:
            - '@pim_catalog.normalizer.standard.attribute_group'
            - '@pimee_security.manager.attribute_group_access'
        tags:
            - { name: pim_standard_format_serializer.normalizer, priority: 110 }

    # authorization
    pimee_authorization_serializer:
        class: Symfony\Component\Serializer\Serializer

    # Encoders
    pimee_authorization_serializer.encoder.json:
        public: false
        class: 'Symfony\Component\Serializer\Encoder\JsonEncoder'
        tags:
            - { name: pimee_authorization_serializer.encoder, priority: 90 }

    pimee_security.normalizer.authorization.product:
        class: '%pimee_security.normalizer.authorization.product.class%'
        tags:
            - { name: pimee_authorization_serializer.normalizer, priority: 110 }

    pimee_security.normalizer.authorization.product_model:
        class: '%pimee_security.normalizer.authorization.product_model.class%'
        tags:
            - { name: pimee_authorization_serializer.normalizer, priority: 110 }

    pimee_security.normalizer.authorization.product_draft:
        class: Akeneo\Pim\Permission\Component\Normalizer\Authorization\ProductDraftNormalizer
        tags:
            - { name: pimee_authorization_serializer.normalizer, priority: 110 }
