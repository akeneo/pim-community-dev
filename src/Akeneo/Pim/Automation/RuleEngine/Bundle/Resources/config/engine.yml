parameters:
    pimee_catalog_rule.applier.product.class:             Akeneo\Pim\Automation\RuleEngine\Component\Engine\ProductRuleApplier
    pimee_catalog_rule.applier.product.updater.class:     Akeneo\Pim\Automation\RuleEngine\Component\Engine\ProductRuleApplier\ProductsUpdater
    pimee_catalog_rule.applier.product.validator.class:   Akeneo\Pim\Automation\RuleEngine\Component\Engine\ProductRuleApplier\ProductsValidator
    pimee_catalog_rule.applier.product.saver.class:       Akeneo\Pim\Automation\RuleEngine\Component\Engine\ProductRuleApplier\ProductsSaver
    pimee_catalog_rule.builder.product.class:             Akeneo\Pim\Automation\RuleEngine\Component\Engine\ProductRuleBuilder
    pimee_catalog_rule.selector.product.class:            Akeneo\Pim\Automation\RuleEngine\Component\Engine\ProductRuleSelector
    # @merge: remove the 2 following parameters in master
    pimee_catalog_rule.paginator.paginator_factory.class: Akeneo\Component\StorageUtils\Cursor\PaginatorFactory
    pimee_catalog_rule.paginator.class:                   Akeneo\Component\StorageUtils\Cursor\Paginator
    pimee_catalog_rule.paginator.page_size: 1000

services:
    # @merge: remove the pimee_catalog_rule.product.paginator service definition in master
    pimee_catalog_rule.product.paginator:
        class: '%pimee_catalog_rule.paginator.paginator_factory.class%'
        arguments:
            - '%pimee_catalog_rule.paginator.class%'
            - '%pimee_catalog_rule.paginator.page_size%'

    pimee_catalog_rule.builder.product:
        class: '%pimee_catalog_rule.builder.product.class%'
        arguments:
            - '@pimee_catalog_rule.denormalizer.product_rule.chained'
            - '@event_dispatcher'
            - '@validator'
            - '%akeneo_rule_engine.model.rule.class%'

    pimee_catalog_rule.selector.product:
        class: '%pimee_catalog_rule.selector.product.class%'
        arguments:
            - '@pim_catalog.query.product_and_product_model_query_builder_factory'
            - '@pim_catalog.repository.product'
            - '@event_dispatcher'
            - '%akeneo_rule_engine.model.rule_subject_set.class%'

    pimee_catalog_rule.applier.product:
        class: '%pimee_catalog_rule.applier.product.class%'
        arguments:
            - '@pimee_catalog_rule.product.paginator'
            - '@pimee_catalog_rule.applier.product.updater'
            - '@pimee_catalog_rule.applier.product.validator'
            - '@pimee_catalog_rule.applier.product.saver'
            - '@event_dispatcher'
            - '@akeneo_storage_utils.doctrine.object_detacher'
            - '@pim_connector.doctrine.cache_clearer'
            - '%pimee_catalog_rule.paginator.page_size%'

    pimee_catalog_rule.applier.product.updater:
        class: '%pimee_catalog_rule.applier.product.updater.class%'
        arguments:
            - '@akeneo_rule_engine.action_applier.registry'

    pimee_catalog_rule.applier.product.validator:
        class: '%pimee_catalog_rule.applier.product.validator.class%'
        arguments:
            - '@pim_catalog.validator.product'
            - '@event_dispatcher'
            - '@akeneo_storage_utils.doctrine.object_detacher'

    pimee_catalog_rule.applier.product.saver:
        class: '%pimee_catalog_rule.applier.product.saver.class%'
        arguments:
            - '@pim_catalog.saver.product'
            - '@pim_catalog.saver.product_model'
            - '@pim_versioning.manager.version'
            - '@pim_versioning.context.version'
            - '@translator'
            - '@pim_catalog.saver.product_model_descendants'
            - '@pim_connector.doctrine.cache_clearer'
