services:

    #Jobs
    akeneo.pim.automation.data_quality_insights.job.evaluations:
        class: '%pim_connector.job.simple_job.class%'
        arguments:
            - 'data_quality_insights_evaluations'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            -
                - '@akeneo.pim.automation.data_quality_insights.connector.step.evaluate_attributes'
                - '@akeneo.pim.automation.data_quality_insights.connector.step.evaluate_attribute_options'
                - '@akeneo.pim.automation.data_quality_insights.connector.step.evaluate_family_criteria'
                - '@akeneo.pim.automation.data_quality_insights.connector.step.evaluate_products_and_product_models_criteria'
        tags:
            - { name: akeneo_batch.job, connector: 'Data Quality Insights Connector', type: 'data_quality_insights' }
            - name: akeneo_batch.job.not_visible

    akeneo.pim.automation.data_quality_insights.job.periodic_tasks:
        class: '%pim_connector.job.simple_job.class%'
        arguments:
            - 'data_quality_insights_periodic_tasks'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            -
                - '@akeneo.pim.automation.data_quality_insights.connector.step.generate_dictionary'
                - '@akeneo.pim.automation.data_quality_insights.connector.step.consolidate_dashboard_rates'
                - '@akeneo.pim.automation.data_quality_insights.connector.step.purge_outdated_data'
                - '@akeneo.pim.automation.data_quality_insights.connector.step.log_metrics'
        tags:
            - { name: akeneo_batch.job, connector: 'Data Quality Insights Connector', type: 'data_quality_insights' }
            - name: akeneo_batch.job.not_visible

    #Steps
    akeneo.pim.automation.data_quality_insights.connector.step.generate_dictionary:
        class: '%pim_connector.step.tasklet.class%'
        arguments:
            - 'generate_dictionary'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            - '@Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Connector\Tasklet\GenerateDictionaryTasklet'

    akeneo.pim.automation.data_quality_insights.connector.step.evaluate_attributes:
        class: '%pim_connector.step.tasklet.class%'
        arguments:
            - 'evaluate_attributes'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            - '@Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Connector\Tasklet\EvaluateAttributesTasklet'

    akeneo.pim.automation.data_quality_insights.connector.step.evaluate_attribute_options:
        class: '%pim_connector.step.tasklet.class%'
        arguments:
            - 'evaluate_attribute_options'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            - '@Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Connector\Tasklet\EvaluateAttributeOptionsTasklet'

    akeneo.pim.automation.data_quality_insights.connector.step.evaluate_family_criteria:
        class: '%pim_connector.step.tasklet.class%'
        arguments:
            - 'evaluate_family_criteria'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            - '@Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Connector\Tasklet\EvaluateFamilyCriteriaTasklet'

    #Tasklets

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Connector\Tasklet\GenerateDictionaryTasklet:
        arguments:
            - '@Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Aspell\AspellDictionaryGenerator'
            - '@Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Aspell\ProductValueInDatabaseDictionarySource'
            - '@logger'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Connector\Tasklet\EvaluateAttributesTasklet:
        arguments:
            - '@Akeneo\Pim\Automation\DataQualityInsights\Application\StructureEvaluation\EvaluateUpdatedAttributes'
            - '@logger'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Connector\Tasklet\EvaluateAttributeOptionsTasklet:
        arguments:
            - '@Akeneo\Pim\Automation\DataQualityInsights\Application\StructureEvaluation\EvaluateUpdatedAttributeOptions'
            - '@logger'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Connector\Tasklet\EvaluateFamilyCriteriaTasklet:
        arguments:
            - '@Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Structure\GetFamilyIdsToEvaluateQuery'
            - '@Akeneo\Pim\Automation\DataQualityInsights\Application\StructureEvaluation\EvaluateFamilyAttributesSpelling'
            - '@logger'

    #Job parameters
    akeneo.pim.automation.data_quality_insights.job_parameters.default_values_provider.evaluate_products_criteria:
        class: Akeneo\Tool\Component\Batch\Job\JobParameters\EmptyDefaultValuesProvider
        arguments:
            - ['data_quality_insights_evaluations']
        tags:
            - { name: akeneo_batch.job.job_parameters.default_values_provider }

    akeneo.pim.automation.data_quality_insights.job_parameters.constraint_collection_provider.evaluate_products_criteria:
        class: Akeneo\Tool\Component\Batch\Job\JobParameters\EmptyConstraintCollectionProvider
        arguments:
            - ['data_quality_insights_evaluations']
        tags:
            - { name: akeneo_batch.job.job_parameters.constraint_collection_provider }

    akeneo.pim.automation.data_quality_insights.job_parameters:
        class: Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Connector\JobParameters\Evaluation
        tags:
            - { name: akeneo_batch.job.job_parameters.constraint_collection_provider }
            - { name: akeneo_batch.job.job_parameters.default_values_provider }

