services:
    akeneo_enrichedentity.attribute_type.enriched_entity_collection:
        class: 'Akeneo\Pim\EnrichedEntity\Component\AttributeType\EnrichedEntityCollectionType'
        arguments:
            - 'reference_data_options'
        tags:
            - { name: pim_catalog.attribute_type, alias: akeneo_enriched_entity_collection, entity: '%pim_catalog.entity.product.class%' }

    akeneo_enrichedentity.enrich.provider.enriched_entity_provider:
        class: 'Akeneo\Pim\EnrichedEntity\Component\Provider\EnrichedEntityProvider'
        tags:
            - { name: pim_enrich.provider.field, priority: 100 }
            - { name: pim_enrich.provider.empty_value, priority: 80 }

    akeneo_enrichedentity.factory.product_value.enriched_entity_collection:
        class: 'Akeneo\Pim\EnrichedEntity\Component\Factory\EnrichedEntityCollectionValueFactory'
        public: false
        arguments:
            - '@akeneo_enrichedentity.infrastructure.persistence.record'
        tags:
            - { name: pim_catalog.factory.value }

    akeneo_enrichedentity.comparator.attribute.enriched_entity:
        class: '%pim_catalog.comparator.attribute.options.class%'
        arguments:
            - ['akeneo_enriched_entity_collection']
        tags:
            - { name: pim_catalog.attribute.comparator }

    akeneo_enrichedentity.updater.setter.product_enriched_entity_value:
        class: 'Pim\Component\Catalog\Updater\Setter\AttributeSetter'
        parent: pim_catalog.updater.setter.abstract
        arguments:
            - ['akeneo_enriched_entity_collection']
        tags:
            - { name: 'pim_catalog.updater.setter' }

    akeneo_enrichedentity.array_converter.standard_to_flat.product.value_converter.enriched_entity:
        class: '%pim_connector.array_converter.standard_to_flat.product.value_converter.multiselect.class%'
        arguments:
            - '@pim_connector.array_converter.flat_to_standard.product.attribute_columns_resolver'
            - ['akeneo_enriched_entity_collection']
        tags:
            - { name: 'pim_connector.array_converter.standard_to_flat.product.value_converter' }

    akeneo_enrichedentity.array_converter.flat_to_standard.product.value_converter.enriched_entity:
        class: '%pim_connector.array_converter.flat_to_standard.product.value_converter.multiselect.class%'
        parent: pim_connector.array_converter.flat_to_standard.product.value_converter.abstract
        arguments:
            - ['akeneo_enriched_entity_collection']
        tags:
            - { name: 'pim_connector.array_converter.flat_to_standard.product.value_converter' }

    akeneo_enrichedentity.validator.constraint.is_enriched_entity_configured:
        class: 'Akeneo\Pim\EnrichedEntity\Component\Validator\Constraints\IsEnrichedEntityConfiguredValidator'
        arguments:
            - ['akeneo_enriched_entity_collection']
            - '@akeneo_enrichedentity.infrastructure.persistence.query.find_enriched_entity_details'
        tags:
            - { name: validator.constraint_validator, alias: pim_is_enriched_entity_configured_validator }

    akeneo_enrichedentity.infrastructure.catalog.normalizer.enriched_entity_collection_value:
        class: 'Akeneo\Pim\EnrichedEntity\Component\Normalizer\EnrichedEntityCollectionValueNormalizer'
        tags:
            - { name: pim_indexing_serializer.normalizer, priority: 90 }

    akeneo_enrichedentity.infrastructure.catalog.normalizer.record:
        class: 'Akeneo\Pim\EnrichedEntity\Component\Normalizer\RecordNormalizer'
        tags:
            - { name: pim_serializer.normalizer, priority: 90 }
            - { name: pim_standard_format_serializer.normalizer, priority: 90 }
            - { name: pim_storage_serializer.normalizer, priority: 90 }
            - { name: pim_versioning.serializer.normalizer, priority: 100 }
