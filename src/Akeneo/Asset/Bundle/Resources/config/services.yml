# TODO: should not be in a services.yml file
parameters:
    pimee_product_asset.variation_file_generator.class:              Akeneo\Asset\Component\VariationFileGenerator
    pimee_product_asset.variations_collection_files_generator.class: Akeneo\Asset\Component\VariationsCollectionFilesGenerator
    pimee_product_asset.command_launcher.class:                      Akeneo\Tool\Component\Console\CommandLauncher

services:
    pimee_product_asset.variation_file_generator:
        class: '%pimee_product_asset.variation_file_generator.class%'
        arguments:
            - '@pimee_product_asset.repository.channel_configuration'
            - '@akeneo_file_storage.file_storage.filesystem_provider'
            - '@pimee_product_asset.saver.file_metadata'
            - '@pimee_product_asset.saver.variation'
            - '@akeneo_file_transformer.file_transformer'
            - '@akeneo_file_storage.file_storage.file.file_storer'
            - '@akeneo_file_storage.file_storage.file.file_fetcher'
            - '@pimee_product_asset.registry.metadata_builder'
            - 'assetStorage'

    pimee_product_asset.variations_collection_files_generator:
        class: '%pimee_product_asset.variations_collection_files_generator.class%'
        arguments:
            - '@pimee_product_asset.variation_file_generator'
            - '@pimee_product_asset.saver.variation'

    pimee_product_asset.command_launcher:
        class: '%pimee_product_asset.command_launcher.class%'
        arguments:
          - '%kernel.root_dir%'
          - '%kernel.environment%'

    Akeneo\Asset\Bundle\Command\GenerateVariationFileCommand:
        arguments:
            - '@pimee_product_asset.finder.asset'
            - '@pimee_product_asset.builder.reference'
            - '@pimee_product_asset.builder.variation'
            - '@pimee_product_asset.saver.asset'
            - '@pimee_product_asset.variation_file_generator'
            - '@pim_catalog.repository.channel'
            - '@pim_catalog.repository.locale'
            - '@pimee_product_asset.repository.asset'
            - '@pimee_product_asset.variations_collection_files_generator'
        tags:
            - { name: console.command }

    Akeneo\Asset\Bundle\Command\GenerateMissingVariationFilesCommand:
        arguments:
            - '@pimee_product_asset.finder.asset'
            - '@pimee_product_asset.builder.reference'
            - '@pimee_product_asset.builder.variation'
            - '@pimee_product_asset.saver.asset'
            - '@pimee_product_asset.variation_file_generator'
            - '@pim_catalog.repository.channel'
            - '@pim_catalog.repository.locale'
            - '@pimee_product_asset.repository.asset'
            - '@pimee_product_asset.variations_collection_files_generator'
            - '@pimee_product_asset.repository.variation'
            - '@pimee_product_asset.query.find_asset_codes_with_missing_variation_with_file'
            - '@pim_connector.doctrine.cache_clearer'
            - '@database_connection'
            - '@event_dispatcher'
        tags:
            - { name: console.command }

    Akeneo\Asset\Bundle\Command\CopyAssetFilesCommand:
        arguments:
            - '%tmp_storage_dir%'
        tags:
            - { name: console.command }

    Akeneo\Asset\Bundle\Command\ProcessMassUploadCommand:
        arguments:
            - '@pimee_product_asset.mass_upload_processor'
            - '%tmp_storage_dir%'
        tags:
            - { name: console.command }

    Akeneo\Asset\Bundle\Command\SendAlertNotificationsCommand:
        arguments:
            - '@pim_user.repository.user'
            - '@pimee_product_asset.repository.asset'
            - '@router'
            - '@templating'
            - '@pim_notification.email.email_notifier'
        tags:
            - { name: console.command }
