services:
    # job profiles
    akeneo.pim.automation.franklin_insights.connector.job.subscribe_products:
        class: '%pim_connector.job.simple_job.class%'
        arguments:
            - 'franklin_insights_subscribe_products'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            -
                - '@akeneo.pim.automation.franklin_insights.connector.step.validate_connection'
                - '@akeneo.pim.automation.franklin_insights.connector.step.validate_identifiers_mapping'
                - '@akeneo.pim.automation.franklin_insights.connector.step.subscribe_products'
                - '@akeneo.pim.automation.franklin_insights.connector.step.create_proposals'
                - '@akeneo.pim.automation.franklin_insights.connector.step.notify_if_pending_attributes'
        tags:
            - { name: akeneo_batch.job, connector: 'Franklin Insights Connector', type: 'mass_edit' }

    akeneo.pim.automation.franklin_insights.connector.job.unsubscribe_products:
        class: '%pim_connector.job.simple_job.class%'
        arguments:
            - 'franklin_insights_unsubscribe_products'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            -
                - '@akeneo.pim.automation.franklin_insights.connector.step.validate_connection'
                - '@akeneo.pim.automation.franklin_insights.connector.step.unsubscribe_products'
        tags:
            - { name: akeneo_batch.job, connector: 'Franklin Insights Connector', type: 'mass_edit' }

    akeneo.pim.automation.franklin_insights.connector.job.resubscribe_products:
        class: '%pim_connector.job.simple_job.class%'
        arguments:
            - 'franklin_insights_resubscribe_products'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            -
                - '@akeneo.pim.automation.franklin_insights.connector.step.validate_connection'
                - '@akeneo.pim.automation.franklin_insights.connector.step.validate_identifiers_mapping'
                - '@akeneo.pim.automation.franklin_insights.connector.step.unsubscribe_products'
                - '@akeneo.pim.automation.franklin_insights.connector.step.subscribe_products'
        tags:
            - { name: akeneo_batch.job, connector: 'Franklin Insights Connector', type: 'franklin_insights' }

    akeneo.pim.automation.franklin_insights.connector.job.fetch_products:
        class: '%pim_connector.job.simple_job.class%'
        arguments:
            - 'franklin_insights_fetch_products'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            -
                - '@akeneo.pim.automation.franklin_insights.connector.step.validate_connection'
                - '@akeneo.pim.automation.franklin_insights.connector.step.fetch_products'
                - '@akeneo.pim.automation.franklin_insights.connector.step.create_proposals'
                - '@akeneo.pim.automation.franklin_insights.connector.step.notify_if_pending_attributes'
        tags:
            - { name: akeneo_batch.job, connector: 'Franklin Insights Connector', type: 'franklin_insights' }

    akeneo.pim.automation.franklin_insights.job.remove_attribute_from_attributes_mapping:
        class: '%pim_connector.job.simple_job.class%'
        arguments:
            - 'franklin_insights_remove_attribute_from_mapping'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            -
                - '@akeneo.pim.automation.franklin_insights.connector.step.validate_connection'
                - '@akeneo.pim.automation.franklin_insights.connector.step.remove_attribute_from_attributes_mapping'
        tags:
            - { name: akeneo_batch.job, connector: 'Franklin Insights Connector', type: 'franklin_insights' }

    akeneo.pim.automation.franklin_insights.job.remove_option_from_attribute_options_mapping:
        class: '%pim_connector.job.simple_job.class%'
        arguments:
            - 'franklin_insights_remove_option_from_mapping'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            -
                - '@akeneo.pim.automation.franklin_insights.connector.step.validate_connection'
                - '@akeneo.pim.automation.franklin_insights.connector.step.remove_option_from_attribute_options_mapping'
        tags:
            - { name: akeneo_batch.job, connector: 'Franklin Insights Connector', type: 'franklin_insights' }

    akeneo.pim.automation.franklin_insights.job.identify_products_to_resubscribe:
        class: '%pim_connector.job.simple_job.class%'
        arguments:
            - 'franklin_insights_identify_products_to_resubscribe'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            -
                - '@akeneo.pim.automation.franklin_insights.connector.step.validate_connection'
                - '@akeneo.pim.automation.franklin_insights.connector.step.compute_products_to_resubscribe'
        tags:
            - { name: akeneo_batch.job, connector: 'Franklin Insights Connector', type: 'franklin_insights' }

    akeneo.pim.automation.franklin_insights.job.synchronize:
        class: '%pim_connector.job.simple_job.class%'
        arguments:
            - 'franklin_insights_synchronize'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
        tags:
            - { name: akeneo_batch.job, connector: 'Franklin Insights Connector', type: 'franklin_insights' }

    # constraint collection providers
    akeneo.pim.automation.franklin_insights.connector.job_parameters.constraint_collection_provider.product_mass_edit:
        class: 'Akeneo\Pim\Enrichment\Component\Product\Connector\Job\JobParameters\ConstraintCollectionProvider\ProductMassEdit'
        arguments:
            -
                - 'franklin_insights_subscribe_products'
                - 'franklin_insights_unsubscribe_products'
                - 'franklin_insights_resubscribe_products'
        tags:
            - { name: akeneo_batch.job.job_parameters.constraint_collection_provider }

    akeneo.pim.automation.franklin_insights.connector.job_parameters.constraint_collection_provider.remove_attribute_from_attributes_mapping:
        class: 'Akeneo\Tool\Component\Batch\Job\JobParameters\EmptyConstraintCollectionProvider'
        arguments:
            -
                - 'franklin_insights_remove_attribute_from_mapping'
        tags:
            - { name: akeneo_batch.job.job_parameters.constraint_collection_provider }

    akeneo.pim.automation.franklin_insights.connector.job_parameters.constraint_collection_provider.remove_option_from_attribute_options_mapping:
        class: 'Akeneo\Tool\Component\Batch\Job\JobParameters\EmptyConstraintCollectionProvider'
        arguments:
            -
                - 'franklin_insights_remove_option_from_mapping'
        tags:
            - { name: akeneo_batch.job.job_parameters.constraint_collection_provider }

    akeneo.pim.automation.franklin_insights.connector.job_parameters.constraint_collection_provider.identify_products_to_resubscribe:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Connector\JobParameters\UpdatedFranklinIdentifiers'
        tags:
            - { name: akeneo_batch.job.job_parameters.constraint_collection_provider }

    akeneo.pim.automation.franklin_insights.connector.job_parameters.constraint_collection_provider.synchronize:
        class: 'Akeneo\Tool\Component\Batch\Job\JobParameters\EmptyConstraintCollectionProvider'
        arguments:
            -
                - 'franklin_insights_synchronize'
        tags:
            - { name: akeneo_batch.job.job_parameters.constraint_collection_provider }

    # default values providers
    akeneo.pim.automation.franklin_insights.connector.job_parameters.default_values_provider.product_mass_edit:
        class: 'Akeneo\Pim\Enrichment\Component\Product\Connector\Job\JobParameters\DefaultValueProvider\ProductMassEdit'
        arguments:
            -
                - 'franklin_insights_subscribe_products'
                - 'franklin_insights_unsubscribe_products'
                - 'franklin_insights_resubscribe_products'
        tags:
            - { name: akeneo_batch.job.job_parameters.default_values_provider }

    akeneo.pim.automation.franklin_insights.connector.job_parameters.default_values_provider.remove_attribute_from_attributes_mapping:
        class: '%akeneo_batch.job.job_parameters.empty_values_provider.class%'
        arguments:
            -
                - 'franklin_insights_remove_attribute_from_mapping'
        tags:
            - { name: akeneo_batch.job.job_parameters.default_values_provider }

    akeneo.pim.automation.franklin_insights.connector.job_parameters.default_values_provider.remove_option_from_attribute_options_mapping:
        class: '%akeneo_batch.job.job_parameters.empty_values_provider.class%'
        arguments:
            -
                - 'franklin_insights_remove_option_from_mapping'
        tags:
            - { name: akeneo_batch.job.job_parameters.default_values_provider }

    akeneo.pim.automation.franklin_insights.connector.job_parameters.default_values_provider.identify_products_to_resubscribe:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Connector\JobParameters\UpdatedFranklinIdentifiers'
        tags:
            - { name: akeneo_batch.job.job_parameters.default_values_provider }

    akeneo.pim.automation.franklin_insights.connector.job_parameters.default_values_provider.synchronize:
        class: '%akeneo_batch.job.job_parameters.empty_values_provider.class%'
        arguments:
            -
                - 'franklin_insights_synchronize'
        tags:
            - { name: akeneo_batch.job.job_parameters.default_values_provider }

    akeneo.pim.automation.franklin_insights.connector.job_parameters.fetch_products:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Connector\JobParameters\DateTimeJobParameterToFetchSubscriptions'
        tags:
            - { name: akeneo_batch.job.job_parameters.default_values_provider }
            - { name: akeneo_batch.job.job_parameters.constraint_collection_provider }

    # job launchers
    akeneo.pim.automation.franklin_insights.connector.job_launcher.schedule_fetch_products:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Connector\JobLauncher\ScheduleFetchProductsJob'
        arguments:
            - '@akeneo_batch_queue.launcher.queue_job_launcher'
            - '@akeneo_batch.job.job_instance_repository'
            - '@pim_user.repository.user'
            - '@akeneo_batch_queue.queue.job_execution_message_repository'
