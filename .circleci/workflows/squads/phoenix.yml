workflows:
    ucs:
      when:
          not:
              equal: [ scheduled_pipeline, << pipeline.trigger_source >> ]
      jobs:
          - ready_to_build?:
                type: approval
                filters:
                    branches:
                        only:
                            - /BH-.*/
                            - /PH-.*/
          - checkout:
                requires:
                    - ready_to_build?
          - build_ucs:
                requires:
                    - checkout
          - deploy_ucs_pim:
                requires:
                    - build_ucs
          - deploy_tenant:
                requires:
                    - build_ucs
          - delete_pim?:
                type: approval
                filters:
                    branches:
                        only:
                            - /BH-.*/
                            - /PH-.*/
                requires:
                    - deploy_ucs_pim
          - delete_pim:
                requires:
                    - delete_pim?
          - delete_tenant?:
                type: approval
                filters:
                    branches:
                        only:
                            - /BH-.*/
                            - /PH-.*/
                requires:
                    - deploy_tenant
          - delete_tenant:
                requires:
                    - delete_tenant?
          - ready_to_build_wb?:
                type: approval
                filters:
                    branches:
                        only:
                            - /BH-.*/
                            - /PH-.*/
          - checkout:
                name: checkout_wb
                requires:
                    - ready_to_build_wb?
          - build_ucs_env_vars:
                name: build_ucs_wb
                requires:
                    - checkout_wb
          - deploy_ucs_pim:
                name: deploy_ucs_pim_wb
                requires:
                    - build_ucs_wb
          - deploy_tenant_wb_timmy:
                name: "deploy_tenant_wb_timmy"
                requires:
                    - build_ucs_wb
          - deploy_tenant:
                name: "deploy_tenant_wb"
                requires:
                    - build_ucs_wb
          - delete_pim_wb?:
                type: approval
                filters:
                    branches:
                        only:
                            - /BH-.*/
                            - /PH-.*/
                requires:
                    - deploy_ucs_pim_wb
          - delete_pim:
                name: "delete_pim_wb"
                requires:
                    - delete_pim_wb?
          - delete_tenant_wb?:
                type: approval
                filters:
                    branches:
                        only:
                            - /BH-.*/
                            - /PH-.*/
                requires:
                    - deploy_tenant_wb
          - delete_tenant_wb_timmy?:
                type: approval
                filters:
                    branches:
                        only:
                            - /BH-.*/
                            - /PH-.*/
                requires:
                    - deploy_tenant_wb_timmy
          - delete_tenant:
                name: "delete_tenant_wb"
                requires:
                    - delete_tenant_wb?
          - delete_tenant_timmy:
                name: "delete_tenant_wb_timmy"
                requires:
                    - delete_tenant_wb_timmy?
          - ready_to_build_test_infra?:
                type: approval
                filters:
                    branches:
                        only:
                            - /BH-.*/
                            - /PH-.*/
          - checkout:
                name: ready_to_build_test_infra
                requires:
                    - ready_to_build_test_infra?
          - build_ucs_infra:
                name: build_ucs_infra
                requires:
                    - ready_to_build_test_infra
