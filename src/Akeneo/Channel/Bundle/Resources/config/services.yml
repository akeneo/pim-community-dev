parameters:
    pim_catalog.model.channel.interface: 'Akeneo\Channel\Component\Model\ChannelInterface'
    akeneo_channel.model.locale.interface: 'Akeneo\Channel\Component\Model\LocaleInterface'
    pim_catalog.entity.locale.class: 'Akeneo\Channel\Component\Model\Locale'
    pim_catalog.entity.channel.class: 'Akeneo\Channel\Component\Model\Channel'
    pim_catalog.model.channel_translation.interface: 'Akeneo\Channel\Component\Model\ChannelTranslationInterface'
    pim_catalog.entity.channel_translation.class: 'Akeneo\Channel\Component\Model\ChannelTranslation'

services:
    ### Locale
    pim_catalog.normalizer.standard.locale:
        class: 'Akeneo\Channel\Component\Normalizer\Standard\LocaleNormalizer'
        tags:
            - { name: pim_serializer.normalizer, priority: 90 }

    pim_catalog.repository.locale:
        class: 'Akeneo\Channel\Bundle\Doctrine\Repository\LocaleRepository'
        factory: 'doctrine.orm.entity_manager:getRepository'
        arguments: ['%pim_catalog.entity.locale.class%']
        tags:
            - { name: 'channel_repository' }

    pim_api.repository.locale:
        class: 'Akeneo\Tool\Bundle\ApiBundle\Doctrine\ORM\Repository\ApiResourceRepository'
        arguments:
            - '@doctrine.orm.entity_manager'
            - '%pim_catalog.entity.locale.class%'
            - '@pim_catalog.repository.locale'

    pim_catalog.validator.constraints.locale_validator:
        class: 'Akeneo\Channel\Component\Validator\Constraint\LocaleValidator'
        arguments:
            - '@pim_catalog.repository.locale'
        tags:
            - { name: validator.constraint_validator, alias: pim_locale_validator }

    pim_catalog.validator.constraint.activated_locale:
        class: 'Akeneo\Channel\Component\Validator\Constraint\ActivatedLocaleValidator'
        arguments:
            - '@pim_catalog.repository.cached_locale'
        tags:
            - { name: validator.constraint_validator, alias: pim_activated_locale_validator }

    pim_catalog.updater.locale:
        class: 'Akeneo\Channel\Component\Updater\LocaleUpdater'

    pim_enrich.event_subscriber.storage.channel_locale:
        class: 'Akeneo\Channel\Bundle\EventListener\ChannelLocaleSubscriber'
        arguments:
            - '@pim_catalog.repository.locale'
            - '@pim_catalog.saver.locale'
            - '@pim_catalog.command_launcher'
            - '@security.token_storage'
        tags:
            - { name: kernel.event_subscriber }

    ### Channel
    pim_catalog.repository.channel:
        class: 'Akeneo\Channel\Bundle\Doctrine\Repository\ChannelRepository'
        factory: 'doctrine.orm.entity_manager:getRepository'
        arguments: ['%pim_catalog.entity.channel.class%']
        tags:
            - { name: 'pim_repository' }

    pim_catalog.normalizer.standard.channel:
        class: 'Akeneo\Channel\Component\Normalizer\Standard\ChannelNormalizer'
        arguments:
            - '@pim_catalog.normalizer.standard.translation'
        tags:
            - { name: pim_serializer.normalizer, priority: 90 }

    pim_catalog.updater.channel:
        class: 'Akeneo\Channel\Component\Updater\ChannelUpdater'
        arguments:
            - '@pim_catalog.repository.category'
            - '@pim_catalog.repository.locale'
            - '@pim_catalog.repository.currency'
            - '@pim_catalog.repository.attribute'
            - '@akeneo_measure.manager'
            - '@pim_localization.updater.translatable'

    pim_catalog.remover.channel:
        class: 'Akeneo\Channel\Bundle\Doctrine\Remover\ChannelRemover'
        arguments:
            - '@doctrine.orm.entity_manager'
            - '@event_dispatcher'
            - '@pim_catalog.repository.channel'
            - '@translator'
            - '%pim_catalog.entity.channel.class%'
