services:
    akeneo.pim.automation.franklin_insights.connector.step.validate_connection:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Connector\Step\ConnectionValidationStep'
        arguments:
            - 'validate_configuration'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            - '@akeneo.pim.automation.franklin_insights.application.configuration.query.get_connection_status_handler'

    akeneo.pim.automation.franklin_insights.connector.step.validate_identifiers_mapping:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Connector\Step\IdentifiersMappingValidationStep'
        arguments:
            - 'validate_identifiers_mapping'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            - '@akeneo.pim.automation.franklin_insights.application.configuration.query.get_connection_status_handler'

    akeneo.pim.automation.franklin_insights.connector.step.subscribe_products:
        class: '%pim_connector.step.item_step.class%'
        arguments:
            - 'subscribe_products'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            - '@pim_enrich.reader.database.product'
            - '@akeneo.pim.automation.franklin_insights.connector.processor.subscription'
            - '@akeneo.pim.automation.franklin_insights.connector.writer.subscription'
            - '%pim_enrich.datagrid.product_batch_size%'

    akeneo.pim.automation.franklin_insights.connector.step.unsubscribe_products:
        class: '%pim_connector.step.item_step.class%'
        arguments:
            - 'unsubscribe_products'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            - '@pim_enrich.reader.database.product'
            - '@akeneo.pim.automation.franklin_insights.connector.processor.unsubscription'
            - '@akeneo.pim.automation.franklin_insights.connector.writer.unsubscription'
            - 1

    akeneo.pim.automation.franklin_insights.connector.step.fetch_products:
        class: '%pim_connector.step.item_step.class%'
        arguments:
            - 'fetch_products'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            - '@akeneo.pim.automation.franklin_insights.connector.reader.suggested_data'
            - '@akeneo.pim.automation.franklin_insights.connector.processor.suggested_data'
            - '@akeneo.pim.automation.franklin_insights.connector.writer.suggested_data'

    akeneo.pim.automation.franklin_insights.connector.step.create_proposals:
        class: '%pim_connector.step.item_step.class%'
        arguments:
            - 'create_proposals'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            - '@akeneo.pim.automation.franklin_insights.connector.reader.pending_subscription'
            - '@akeneo.pim.automation.franklin_insights.connector.processor.pending_subscription'
            - '@akeneo.pim.automation.franklin_insights.connector.writer.proposal'

    akeneo.pim.automation.franklin_insights.connector.step.remove_attribute_from_attributes_mapping:
        class: '%pim_connector.step.tasklet.class%'
        arguments:
            - 'update_attribute_mapping'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            - '@akeneo.pim.automation.franklin_insights.connector.tasklet.remove_attribute_from_attributes_mapping'

    akeneo.pim.automation.franklin_insights.connector.step.remove_option_from_attribute_options_mapping:
        class: '%pim_connector.step.tasklet.class%'
        arguments:
            - 'update_attribute_options_mapping'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            - '@akeneo.pim.automation.franklin_insights.connector.tasklet.remove_option_from_attribute_options_mapping'

    akeneo.pim.automation.franklin_insights.connector.step.compute_products_to_resubscribe:
        class: '%pim_connector.step.tasklet.class%'
        arguments:
            - 'compute_products_to_resubscribe'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            - '@akeneo.pim.automation.franklin_insights.connector.tasklet.identify_products_to_resubscribe'

    akeneo.pim.automation.franklin_insights.connector.step.notify_if_pending_attributes:
        class: '%pim_connector.step.tasklet.class%'
        arguments:
            - 'notify_if_pending_attributes'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            - '@akeneo.pim.automation.franklin_insights.connector.tasklet.notify_if_pending_attributes'

    akeneo.pim.automation.franklin_insights.connector.step.push_structure_and_products:
        class: '%pim_connector.step.tasklet.class%'
        arguments:
            - 'push_structure_and_products_to_franklin'
            - '@event_dispatcher'
            - '@akeneo_batch.job_repository'
            - '@Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Connector\Tasklet\PushStructureAndProductsToFranklinTasklet'
