workflows:
  # Description :
  #    Delete a given instance when workflow is triggered from circleci
  on_demand_delete_instance:
    when:
      and:
        - equal: [ "delete_instance", << pipeline.parameters.trigger >> ]
        - not:
            equal: [ "", << pipeline.parameters.instance >> ]
    jobs:
      - checkout
      - delete_environment:
          name: "Delete instance << pipeline.parameters.instance >>"
          INSTANCE_NAME: << pipeline.parameters.instance >>
          requires:
            - checkout
