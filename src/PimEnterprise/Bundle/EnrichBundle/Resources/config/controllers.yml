parameters:
    pim_enrich.controller.category_tree.class:    PimEnterprise\Bundle\EnrichBundle\Controller\CategoryTreeController
    pim_enrich.controller.product.class:          PimEnterprise\Bundle\EnrichBundle\Controller\ProductController
    pim_enrich.controller.sequential_edit.class:  PimEnterprise\Bundle\EnrichBundle\Controller\SequentialEditController
    pim_enrich.controller.mass_edit_action.class: PimEnterprise\Bundle\EnrichBundle\Controller\MassEditActionController
    pim_enrich.controller.locale.class:           PimEnterprise\Bundle\EnrichBundle\Controller\LocaleController
    pimee_enrich.controller.rule_relation.class:  PimEnterprise\Bundle\EnrichBundle\Controller\RuleRelationController

services:
    # overriden to add security checks and use a smarter product saver which update draft or working copy
    pim_enrich.controller.product:
        scope: request
        class: %pim_enrich.controller.product.class%
        parent: pim_enrich.controller.abstract_doctrine
        arguments:
            - '@pim_catalog.manager.product'
            - '@pim_catalog.manager.category'
            - '@pim_user.context.user'
            - '@pim_versioning.manager.version'
            - '@oro_security.security_facade'
            - '@pim_catalog.manager.product_category'
            - '@pimee_workflow.saver.product_delegating'
            - '@pim_catalog.manager.media'
            - '@pim_enrich.manager.sequential_edit'
            - '@pim_catalog.remover.product'
            - '@pim_catalog.builder.product'
            - '@pim_catalog.factory.category'

    pim_enrich.controller.rest.product:
        class: %pim_enrich.controller.rest.product.class%
        arguments:
            - '@pim_catalog.repository.product'
            - '@pim_catalog.repository.attribute'
            - '@pim_catalog.updater.product'
            - '@pimee_workflow.saver.product_delegating'
            - '@pim_internal_api_serializer'
            - '@pim_validator'
            - '@pim_user.context.user'
            - '@pim_catalog.filter.chained'
            - '@pim_enrich.filter.product_edit_data'
            - '@pim_catalog.builder.product'

    pimee_enrich.controller.rule_relation:
        class: %pimee_enrich.controller.rule_relation.class%
        arguments:
            - '@pimee_catalog_rule.repository.rule_relation'
            - '@pim_internal_api_serializer'
            - '@pim_catalog.resolver.fqcn'

    # overidden to filter categories with a chained filter that handles permissions
    pim_enrich.controller.category_tree:
        scope: request
        class: %pim_enrich.controller.category_tree.class%
        parent: pim_enrich.controller.abstract_doctrine
        arguments:
            - '@pim_catalog.manager.category'
            - '@pim_user.context.user'
            - '@oro_security.security_facade'
            - '@pim_catalog.saver.category'
            - '@pim_catalog.remover.category'
            - '@pim_catalog.factory.category'
            - '@pim_catalog.repository.category'
            - '@pim_catalog.filter.chained'
