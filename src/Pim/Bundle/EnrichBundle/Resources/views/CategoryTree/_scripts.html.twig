<script type="text/javascript">
    require(
        ['jquery', 'backbone', 'pim/tree/manage', 'jquery.sidebarize', 'bootstrap'],
        function($, Backbone, TreeManage){
            'use strict';
            $(function() {
                var buttons = [];
                {% if resource_granted(acl ~ '_category_create') %}
                    buttons.push($('<a>', {
                        'class': 'no-hash',
                        'data-toggle': 'tooltip',
                        'data-placement': 'right',
                        'data-original-title': '{{ "btn.create.tree"|trans|capitalize }}'
                    }).html(
                        $('<i>', { 'class': 'icon-plus-sign' })
                    ).on('click', function () {
                        Backbone.history.navigate('{{ path(route ~ '_categorytree_create', { parent: 0 }) }}', { trigger: true });
                    }).tooltip());
                {% endif %}
                // Instantiate sidebar
                $('#category-tree-container').sidebarize({ buttons: buttons });
                new TreeManage('#tree', '{{ route }}');
            });
        }
    );
</script>
