parameters:
    akeneo.pim.automation.suggest_data.application.create_proposals.batch_size: 10

services:

    # Command Handlers
    akeneo.pim.automation.suggest_data.application.configuration.command.activate_connection_handler:
        class: 'Akeneo\Pim\Automation\SuggestData\Application\Configuration\Command\ActivateConnectionHandler'
        arguments:
            - '@akeneo.pim.automation.suggest_data.application.configuration.validator.connection'
            - '@akeneo.pim.automation.suggest_data.repository.configuration'

    akeneo.pim.automation.suggest_data.handler.update_identifiers_mapping:
        class: 'Akeneo\Pim\Automation\SuggestData\Application\Mapping\Command\UpdateIdentifiersMappingHandler'
        arguments:
            - '@pim_catalog.repository.attribute'
            - '@akeneo.pim.automation.suggest_data.repository.identifiers_mapping'
            - '@akeneo.pim.automation.suggest_data.data_provider.identifiers_mapping'

    akeneo.pim.automation.suggest_data.handler.subscribe_product:
        class: 'Akeneo\Pim\Automation\SuggestData\Application\ProductSubscription\Command\SubscribeProductHandler'
        arguments:
            - '@pim_catalog.repository.product_without_permission'
            - '@akeneo.pim.automation.suggest_data.repository.product_subscription'
            - '@akeneo.pim.automation.suggest_data.data_provider.product_subscription'
            - '@akeneo.pim.automation.suggest_data.repository.identifiers_mapping'
            - '@akeneo.pim.automation.suggest_data.handler.create_proposal'

    akeneo.pim.automation.suggest_data.product_subscription.handler.unsubscribe_product:
        class: 'Akeneo\Pim\Automation\SuggestData\Application\ProductSubscription\Command\UnsubscribeProductHandler'
        arguments:
            - '@akeneo.pim.automation.suggest_data.repository.product_subscription'
            - '@akeneo.pim.automation.suggest_data.data_provider.product_subscription'

    akeneo.pim.automation.suggest_data.product_subscription.handler.fetch_products:
        class: 'Akeneo\Pim\Automation\SuggestData\Application\ProductSubscription\Command\FetchProductsHandler'
        arguments:
            - '@akeneo.pim.automation.suggest_data.data_provider.product_subscription'
            - '@akeneo.pim.automation.suggest_data.repository.product_subscription'

    akeneo.pim.automation.suggest_data.handler.create_proposal:
        class: 'Akeneo\Pim\Automation\SuggestData\Application\Proposal\Command\CreateProposalHandler'
        arguments:
            - '@akeneo.pim.automation.suggest_data.proposal.factory.suggested_data'
            - '@akeneo.pim.automation.suggest_data.proposal.create_proposal'

    akeneo.pim.automation.suggest_data.handler.create_proposals:
        class: 'Akeneo\Pim\Automation\SuggestData\Application\Proposal\Command\CreateProposalsHandler'
        arguments:
            - '@akeneo.pim.automation.suggest_data.proposal.create_proposal'
            - '@akeneo.pim.automation.suggest_data.repository.product_subscription'
            - '@akeneo.pim.automation.suggest_data.proposal.factory.suggested_data'
            - '%akeneo.pim.automation.suggest_data.application.create_proposals.batch_size%'

    akeneo.pim.automation.suggest_data.handler.update_attributes_mapping_by_family:
        class: 'Akeneo\Pim\Automation\SuggestData\Application\Mapping\Command\UpdateAttributesMappingByFamilyHandler'
        arguments:
            - '@pim_catalog.repository.family'
            - '@pim_catalog.repository.attribute'
            - '@akeneo.pim.automation.suggest_data.data_provider.attributes_mapping'

    akeneo.pim.automation.suggest_data.handler.save_attribute_options_mapping:
        class: 'Akeneo\Pim\Automation\SuggestData\Application\Mapping\Command\SaveAttributeOptionsMappingHandler'
        arguments:
            - '@akeneo.pim.automation.suggest_data.data_provider.attribute_options_mapping'
            - '@pim_catalog.repository.family'
            - '@pim_catalog.repository.attribute'
            - '@pim_catalog.repository.attribute_option'

    # Query Handlers
    akeneo.pim.automation.suggest_data.handler.get_product_subscription_status:
        class: 'Akeneo\Pim\Automation\SuggestData\Application\ProductSubscription\Query\GetProductSubscriptionStatusHandler'
        arguments:
            - '@akeneo.pim.automation.suggest_data.repository.product_subscription'
            - '@akeneo.pim.automation.suggest_data.application.configuration.query.get_connection_status_handler'
            - '@pim_catalog.repository.product_without_permission'
            - '@akeneo.pim.automation.suggest_data.repository.identifiers_mapping'

    akeneo.pim.automation.suggest_data.handler.get_attributes_mapping_by_family:
        class: 'Akeneo\Pim\Automation\SuggestData\Application\Mapping\Query\GetAttributesMappingByFamilyHandler'
        arguments:
            - '@akeneo.pim.automation.suggest_data.data_provider.attributes_mapping'
            - '@pim_catalog.repository.family'

    akeneo.pim.automation.suggest_data.handler.get_attribute_options_mapping_by_family_and_attribute:
        class: 'Akeneo\Pim\Automation\SuggestData\Application\Mapping\Query\GetAttributeOptionsMappingHandler'
        arguments:
            - '@akeneo.pim.automation.suggest_data.data_provider.attribute_options_mapping'
            - '@pim_catalog.repository.family'

    akeneo.pim.automation.suggest_data.handler.get_families:
        class: 'Akeneo\Pim\Automation\SuggestData\Application\Mapping\Query\SearchFamiliesHandler'
        arguments:
            - '@akeneo.pim.automation.suggest_data.repository.search_family'
            - '@akeneo.pim.automation.suggest_data.infrastructure.persistence.query.attribute_mapping.get_statuses_for_families'

    akeneo.pim.automation.suggest_data.application.configuration.query.get_connection_status_handler:
        class: 'Akeneo\Pim\Automation\SuggestData\Application\Configuration\Query\GetConnectionStatusHandler'
        arguments:
            - '@akeneo.pim.automation.suggest_data.repository.configuration'
            - '@akeneo.pim.automation.suggest_data.data_provider.authentication'
            - '@akeneo.pim.automation.suggest_data.repository.identifiers_mapping'

    akeneo.pim.automation.suggest_data.application.configuration.query.get_configuration_handler:
        class: 'Akeneo\Pim\Automation\SuggestData\Application\Configuration\Query\GetConfigurationHandler'
        arguments:
            - '@akeneo.pim.automation.suggest_data.repository.configuration'

    akeneo.pim.automation.suggest_data.handler.get_identifiers_mapping:
        class: 'Akeneo\Pim\Automation\SuggestData\Application\Mapping\Query\GetIdentifiersMappingHandler'
        arguments:
            - '@akeneo.pim.automation.suggest_data.repository.identifiers_mapping'
