parameters:
    pimee_catalog.security.updater.setter.granted_category_field.class: PimEnterprise\Component\Catalog\Security\Updater\Setter\GrantedCategoryFieldSetter
    pimee_catalog.security.updater.setter.granted_association_field.class: PimEnterprise\Component\Catalog\Security\Updater\Setter\GrantedAssociationFieldSetter
    pimee_catalog.security.updater.entity_with_granted_values_property_setter.class: PimEnterprise\Component\Catalog\Security\Updater\Setter\EntityWithGrantedValuesPropertySetter
    pimee_catalog.security.updater.granted_product.class: PimEnterprise\Component\Catalog\Security\Updater\GrantedProductUpdater
    pimee_catalog.security.updater.granted_product_model.class: PimEnterprise\Component\Catalog\Security\Updater\GrantedProductModelUpdater

services:
    pimee_catalog.security.updater.setter.granted_category_field:
        class: '%pimee_catalog.security.updater.setter.granted_category_field.class%'
        decorates: pim_catalog.updater.setter.category_field
        decoration_inner_name: pim_catalog.updater.category_field_without_permission
        arguments:
            - '@pim_catalog.updater.category_field_without_permission'
            - '@security.authorization_checker'
            - '@pimee_security.repository.category_access'
            - '@security.token_storage'
            - '@doctrine.orm.entity_manager'
            - ['categories']
        tags:
            - { name: 'pim_catalog.updater.setter' }

    pimee_catalog.security.updater.setter.granted_association_field:
        class: '%pimee_catalog.security.updater.setter.granted_association_field.class%'
        decorates: pim_catalog.updater.setter.association_field
        decoration_inner_name: pim_catalog.updater.association_field_without_permission
        arguments:
            - '@pim_catalog.updater.association_field_without_permission'
            - '@security.authorization_checker'
            - '@pim_catalog.repository.product_without_permission'
            - ['associations']
            - '@pim_catalog.repository.product_model_without_permission'
            - '@pimee_security.query.product_category_access'
            - '@pimee_security.query.product_model_category_access'
            - '@security.token_storage'
        tags:
            - { name: 'pim_catalog.updater.setter' }

    pimee_catalog.security.updater.entity_with_granted_values_property_setter:
        class: '%pimee_catalog.security.updater.entity_with_granted_values_property_setter.class%'
        decorates: pim_catalog.updater.property_setter
        decoration_inner_name: pim_catalog.updater.entity_with_values_property_setter_without_permission
        arguments:
            - '@pim_catalog.updater.entity_with_values_property_setter_without_permission'
            - '@security.authorization_checker'
            - '@pim_catalog.repository.cached_attribute'
            - '@pim_catalog.repository.cached_locale'

    pim_catalog.updater.entity_with_values_without_permission:
        class: '%pim_catalog.updater.entity_with_values.class%'
        arguments:
            - '@pim_catalog.updater.entity_with_values_property_setter_without_permission'

    pimee_catalog.security.updater.granted_product:
        class: '%pimee_catalog.security.updater.granted_product.class%'
        decorates: pim_catalog.updater.product
        decoration_inner_name: pim_catalog.updater.product_with_values_permission
        arguments:
            - '@pim_catalog.updater.product_with_values_permission'
            - '@security.authorization_checker'
            - '@pim_catalog.comparator.filter.product_field'
            - '@pim_catalog.comparator.filter.product_association'
            - '@pim_catalog.comparator.filter.product'
            - ['enabled', 'family', 'categories', 'groups']
            - ['associations']

    pimee_catalog.security.updater.granted_product_model:
        class: '%pimee_catalog.security.updater.granted_product_model.class%'
        decorates: pim_catalog.updater.product_model
        decoration_inner_name: pim_catalog.updater.product_model_with_values_permission
        arguments:
            - '@pim_catalog.updater.product_model_with_values_permission'
            - '@security.authorization_checker'
            - '@pim_catalog.comparator.filter.product_model'
            - ['categories']

    pim_catalog.updater.product_without_permission:
        class: '%pim_catalog.updater.product.class%'
        arguments:
            - '@pim_catalog.updater.property_setter'
            - '@pim_catalog.updater.entity_with_values_without_permission'
            - '@pim_catalog.association.filter.parent_associations'
            - ['enabled', 'family', 'categories', 'groups', 'associations']
            - ['identifier', 'created', 'updated', 'metadata', 'parent_associations']

    pim_catalog.updater.product:
        class: '%pim_catalog.updater.product.class%'
        arguments:
            - '@pim_catalog.updater.property_setter'
            - '@pim_catalog.updater.entity_with_values'
            - '@pim_catalog.association.filter.parent_associations'
            - ['enabled', 'family', 'categories', 'groups', 'associations', 'parent', 'parent_associations']
            - ['identifier', 'created', 'updated', 'metadata', 'parent_associations']

    pim_catalog.updater.setter.association_field:
        class: '%pim_catalog.updater.setter.association_field.class%'
        arguments:
            - '@pim_catalog.repository.product_without_permission'
            - '@pim_catalog.repository.product_model_without_permission'
            - '@pim_catalog.repository.group'
            - '@pim_catalog.builder.product'
            - ['associations']
        tags:
            - { name: 'pim_catalog.updater.setter' }
