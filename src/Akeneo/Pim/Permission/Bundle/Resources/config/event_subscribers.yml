parameters:
    # Datagrid
    pimee_security.event_subscriber.datagrid.product_category_access.class: Akeneo\Pim\Permission\Bundle\Datagrid\EventListener\ProductCategoryAccessSubscriber

    # Enrich
    pimee_security.event_subscriber.enrich.job_permissions.class:            Akeneo\Pim\Permission\Bundle\EventSubscriber\Enrich\JobPermissionsSubscriber

    pimee_security.event_subscriber.add_default_permissions.class: Akeneo\Pim\Permission\Bundle\EventSubscriber\AddDefaultPermissionsSubscriber
    pimee_security.subscriber.save_permissions.class: Akeneo\Pim\Permission\Bundle\EventSubscriber\SavePermissionsSubscriber

services:
    # Datagrid
    pimee_security.event_subscriber.datagrid.product_category_access:
        class: '%pimee_security.event_subscriber.datagrid.product_category_access.class%'
        arguments:
            - '@security.token_storage'
            - '@pimee_security.repository.category_access'
        tags:
            - { name: kernel.event_subscriber }

    # Enrich
    pimee_security.event_subscriber.enrich.job_permissions:
        class: '%pimee_security.event_subscriber.enrich.job_permissions.class%'
        arguments:
            - '@security.authorization_checker'
        tags:
            - { name: kernel.event_subscriber }

    pimee_security.event_subscriber.add_default_permissions:
        class: '%pimee_security.event_subscriber.add_default_permissions.class%'
        arguments:
            - '@pim_user.repository.group'
            - '@pimee_security.manager.attribute_group_access'
            - '@pimee_security.manager.job_profile_access'
            - '@pimee_security.manager.category_access'
            - '@pimee_product_asset.manager.category_access'
        tags:
            - { name: kernel.event_subscriber }

    pimee_security.subscriber.save_permissions:
        class: '%pimee_security.subscriber.save_permissions.class%'
        arguments:
            - '@pim_user.repository.group'
            - '@pimee_security.manager.attribute_group_access'
            - '@pimee_security.manager.job_profile_access'
        tags:
            - { name: kernel.event_subscriber }

    pimee_security.subscriber.remove_user_group:
        class: Akeneo\Pim\Permission\Bundle\EventSubscriber\RemoveUserGroupSubscriber
        arguments:
            - '@pimee_security.query.find_reference_entity_where_user_group_is_last_to_have_edit_right'
        tags:
            - { name: kernel.event_subscriber }
