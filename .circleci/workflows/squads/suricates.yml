version: 2.1
workflows:
  version: 2

  suricates_pull_request:
    when:
      not:
        equal: [ scheduled_pipeline, << pipeline.trigger_source >> ]
    jobs:
      - ready_to_build?:
          type: approval
          filters:
            branches:
              only:
                - /SURI-.*/
                - /OB2-.*/
                - /OBS-.*/
      - checkout:
          requires:
            - ready_to_build?
      - build_srnt_dev:
          requires:
            - checkout
      - test_onboarder_unit_back:
          requires:
            - build_srnt_dev
      - test_onboarder_integration_back:
          requires:
            - build_srnt_dev
      - test_onboarder_coupling:
          requires:
            - build_srnt_dev
      - pull_request_success:
          requires:
            - test_onboarder_unit_back
            - test_onboarder_integration_back
            - test_onboarder_coupling
