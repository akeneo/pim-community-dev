<?php

namespace Pim\Bundle\DataGridBundle\Controller;

use Oro\Bundle\DataGridBundle\Datagrid\MetadataParser;
use Symfony\Bundle\FrameworkBundle\Templating\EngineInterface;
use Symfony\Component\HttpFoundation\JsonResponse;
use Symfony\Component\HttpFoundation\Request;

/**
 * Datagrid controller
 *
 * @author    Filips Alpe <filips@akeneo.com>
 * @copyright 2014 Akeneo SAS (http://www.akeneo.com)
 * @license   http://opensource.org/licenses/osl-3.0.php  Open Software License (OSL 3.0)
 */
class DatagridController
{
    /**
     * @var EngineInterface
     */
    protected $templating;

    /**
     * @param EngineInterface $templating
     * @param MetadataParser  $metadata
     */
    public function __construct(EngineInterface $templating, MetadataParser $metadata)
    {
        $this->templating = $templating;
        $this->metadata   = $metadata;
    }

    /**
     * Load a datagrid
     *
     * @param Request $request
     * @param string  $alias
     *
     * @return JsonResponse
     */
    public function loadAction(Request $request, $alias)
    {
        $params = $request->get('params', []);

        return new JsonResponse([
            'metadata' => $this->metadata->getGridMetadata($alias, $params),
            'data' => '{"data":[{"identifier":"16466450","image":null,"label":"Lenovo M0620","family":"Loudspeakers","enabled":true,"completeness":50,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1229","document_type":"product","technical_id":"1229","delete_link":"\/enrich\/product\/rest\/1229","toggle_status_link":"\/enrich\/product\/1229\/toggle-status"},{"identifier":"13710067","image":null,"label":"Fujifilm FinePix S4200","family":"Digital cameras","enabled":true,"completeness":28,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1218","document_type":"product","technical_id":"1218","delete_link":"\/enrich\/product\/rest\/1218","toggle_status_link":"\/enrich\/product\/1218\/toggle-status"},{"identifier":"594877","image":null,"label":"Xerox DocuMate 152","family":"Scanners","enabled":true,"completeness":60,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1207","document_type":"product","technical_id":"1207","delete_link":"\/enrich\/product\/rest\/1207","toggle_status_link":"\/enrich\/product\/1207\/toggle-status"},{"identifier":"14191635","image":null,"label":"Samsung DV 300F","family":"Digital cameras","enabled":true,"completeness":28,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1196","document_type":"product","technical_id":"1196","delete_link":"\/enrich\/product\/rest\/1196","toggle_status_link":"\/enrich\/product\/1196\/toggle-status"},{"identifier":"12830519","image":null,"label":"HP LD4730G","family":"PC Monitors","enabled":true,"completeness":60,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1185","document_type":"product","technical_id":"1185","delete_link":"\/enrich\/product\/rest\/1185","toggle_status_link":"\/enrich\/product\/1185\/toggle-status"},{"identifier":"8617001","image":null,"label":"Samsung 100UP","family":"Camcorders","enabled":true,"completeness":66,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1174","document_type":"product","technical_id":"1174","delete_link":"\/enrich\/product\/rest\/1174","toggle_status_link":"\/enrich\/product\/1174\/toggle-status"},{"identifier":"14962869","image":null,"label":"GEAR4 Classic Red Bird","family":"Loudspeakers","enabled":true,"completeness":50,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1163","document_type":"product","technical_id":"1163","delete_link":"\/enrich\/product\/rest\/1163","toggle_status_link":"\/enrich\/product\/1163\/toggle-status"},{"identifier":"127469","image":null,"label":"HP LaserJet 1160 Printer","family":"Laser and LED printers","enabled":true,"completeness":40,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1152","document_type":"product","technical_id":"1152","delete_link":"\/enrich\/product\/rest\/1152","toggle_status_link":"\/enrich\/product\/1152\/toggle-status"},{"identifier":"10977324","image":null,"label":"Brother MFC-J5910DW multifunctional","family":"Multifunctionals","enabled":true,"completeness":66,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1145","document_type":"product","technical_id":"1145","delete_link":"\/enrich\/product\/rest\/1145","toggle_status_link":"\/enrich\/product\/1145\/toggle-status"},{"identifier":"3669355","image":null,"label":"Trust MiDo 2.1 Speaker Set","family":"Loudspeakers","enabled":true,"completeness":50,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1133","document_type":"product","technical_id":"1133","delete_link":"\/enrich\/product\/rest\/1133","toggle_status_link":"\/enrich\/product\/1133\/toggle-status"},{"identifier":"13689212","image":null,"label":"Canon LEGRIA HF M52","family":"Camcorders","enabled":true,"completeness":66,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1134","document_type":"product","technical_id":"1134","delete_link":"\/enrich\/product\/rest\/1134","toggle_status_link":"\/enrich\/product\/1134\/toggle-status"},{"identifier":"1314976","image":{"filePath":"4\/a\/5\/8\/4a58be02305cc830aba29c1f05fed594f5c5f47f_1314976_5566.jpg","originalFilename":"1314976-5566.jpg"},"label":"Sony SS-SP32FWB","family":"Loudspeakers","enabled":true,"completeness":50,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1122","document_type":"product","technical_id":"1122","delete_link":"\/enrich\/product\/rest\/1122","toggle_status_link":"\/enrich\/product\/1122\/toggle-status"},{"identifier":"15705882","image":null,"label":"Lexmark MS812dtn","family":"Laser and LED printers","enabled":true,"completeness":60,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1111","document_tâ€¦"\/enrich\/product\/rest\/1111","toggle_status_link":"\/enrich\/product\/1111\/toggle-status"},{"identifier":"7820677","image":null,"label":"Microsoft LifeCam Studio for Business","family":"Webcams","enabled":true,"completeness":66,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1100","document_type":"product","technical_id":"1100","delete_link":"\/enrich\/product\/rest\/1100","toggle_status_link":"\/enrich\/product\/1100\/toggle-status"},{"identifier":"1325806","image":null,"label":"Kodak EasyShare ZD710","family":"Digital cameras","enabled":true,"completeness":28,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1089","document_type":"product","technical_id":"1089","delete_link":"\/enrich\/product\/rest\/1089","toggle_status_link":"\/enrich\/product\/1089\/toggle-status"},{"identifier":"8009612","image":null,"label":"Kodak i2400","family":"Scanners","enabled":true,"completeness":60,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1078","document_type":"product","technical_id":"1078","delete_link":"\/enrich\/product\/rest\/1078","toggle_status_link":"\/enrich\/product\/1078\/toggle-status"},{"identifier":"1320064","image":null,"label":"Lenovo Flat Panel Performance ThinkVision L190x","family":"PC Monitors","enabled":true,"completeness":60,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1067","document_type":"product","technical_id":"1067","delete_link":"\/enrich\/product\/rest\/1067","toggle_status_link":"\/enrich\/product\/1067\/toggle-status"},{"identifier":"11275331","image":null,"label":"Viewsonic Value Series VA2703","family":"PC Monitors","enabled":true,"completeness":60,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1056","document_type":"product","technical_id":"1056","delete_link":"\/enrich\/product\/rest\/1056","toggle_status_link":"\/enrich\/product\/1056\/toggle-status"},{"identifier":"10627329","image":{"filePath":"8\/d\/0\/0\/8d0087574b3ec6aea4bcb0d681350275aca2f484_10627329_7290.jpg","originalFilename":"10627329-7290.jpg"},"label":"NEC EX201W","family":"PC Monitors","enabled":true,"completeness":60,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1045","document_type":"product","technical_id":"1045","delete_link":"\/enrich\/product\/rest\/1045","toggle_status_link":"\/enrich\/product\/1045\/toggle-status"},{"identifier":"14101037","image":null,"label":"Toshiba 23DL933G LED TV","family":"LED TVs","enabled":true,"completeness":75,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1034","document_type":"product","technical_id":"1034","delete_link":"\/enrich\/product\/rest\/1034","toggle_status_link":"\/enrich\/product\/1034\/toggle-status"},{"identifier":"1712634","image":null,"label":"Sony NWZ-E438F","family":"MP3 players","enabled":true,"completeness":50,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1022","document_type":"product","technical_id":"1022","delete_link":"\/enrich\/product\/rest\/1022","toggle_status_link":"\/enrich\/product\/1022\/toggle-status"},{"identifier":"16672632","image":null,"label":"HP KQ245AA","family":"Webcams","enabled":true,"completeness":66,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1023","document_type":"product","technical_id":"1023","delete_link":"\/enrich\/product\/rest\/1023","toggle_status_link":"\/enrich\/product\/1023\/toggle-status"},{"identifier":"11704300","image":null,"label":"Canon i-SENSYS MF4410","family":"Multifunctionals","enabled":true,"completeness":66,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1011","document_type":"product","technical_id":"1011","delete_link":"\/enrich\/product\/rest\/1011","toggle_status_link":"\/enrich\/product\/1011\/toggle-status"},{"identifier":"12249740","image":{"filePath":"b\/2\/9\/4\/b2948932f272d1c41189d11e9f0833b357db3545_12249740_4511.jpg","originalFilename":"12249740-4511.jpg"},"label":"Avision AV36","family":"Scanners","enabled":true,"completeness":60,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_1000","document_type":"product","technical_id":"1000","delete_link":"\/enrich\/product\/rest\/1000","toggle_status_link":"\/enrich\/product\/1000\/toggle-status"},{"identifier":"13526654","image":null,"label":"Philips 17S1AB","family":"PC Monitors","enabled":true,"completeness":60,"created":"05\/31\/2018","updated":"05\/31\/2018","complete_variant_products":null,"id":"product_989","document_type":"product","technical_id":"989","delete_link":"\/enrich\/product\/rest\/989","toggle_status_link":"\/enrich\/product\/989\/toggle-status"}],"totalRecords":1049,"options":{"totalRecords":null}'
        ]);
    }
}
