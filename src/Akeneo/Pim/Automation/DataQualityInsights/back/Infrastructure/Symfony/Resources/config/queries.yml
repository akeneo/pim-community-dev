services:
    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Structure\CachedGetAllActivatedLocalesQuery:
        arguments:
            - '@database_connection'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\ProductEnrichment\GetDescendantVariantProductIds:
        arguments:
            - '@database_connection'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Structure\GetAttributeLabelsQuery:
        arguments:
            - '@database_connection'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Structure\GetAttributesCodesToEvaluateQuery:
        arguments:
            - '@database_connection'
            - '@akeneo.pim.automation.data_quality_insights.elasticsearch.get_updated_product_ids_query'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Structure\GetNumberOfProductsImpactedByAttributeSpellingMistakesQuery:
        arguments:
            - '@database_connection'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Structure\GetAttributeOptionLabelsQuery:
        arguments:
            - '@database_connection'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Structure\GetAttributeOptionCodesToEvaluateQuery:
        arguments:
            - '@database_connection'
            - '%pim_catalog.entity.attribute_option.class%'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Structure\GetAttributeSpellcheckQuery:
        arguments:
            - '@database_connection'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Structure\GetAttributeOptionSpellcheckQuery:
        arguments:
            - '@database_connection'
            - '@Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Clock\SystemClock'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Structure\IsAttributeLocalizableQuery:
        arguments:
            - '@database_connection'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Structure\GetAllAttributeOptionsSpellcheckQuery:
        arguments: ['@database_connection']

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\ProductEvaluation\GetProductIdsWithOutdatedAttributeSpellcheckQuery:
        arguments:
            - '@database_connection'
            - '@Akeneo\Pim\Automation\DataQualityInsights\Application\ProductIdFactory'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\ProductEvaluation\GetProductModelIdsWithOutdatedAttributeSpellcheckQuery:
        arguments:
            - '@database_connection'
            - '@Akeneo\Pim\Automation\DataQualityInsights\Application\ProductModelIdFactory'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Structure\GetProductModelFamilyAttributeCodesQuery:
        arguments:
            - '@database_connection'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Structure\GetFamiliesWithUpdatedAttributesListQuery:
        arguments:
            - '@database_connection'
            - '@Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Clock\SystemClock'
            - '%pim_catalog.entity.family.class%'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\ProductEvaluation\GetProductIdsWithUpdatedFamilyAttributesListQuery:
        arguments:
            - '@database_connection'
            - '@Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Structure\GetFamiliesWithUpdatedAttributesListQuery'
            - '@Akeneo\Pim\Automation\DataQualityInsights\Application\ProductIdFactory'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\ProductEvaluation\GetProductModelIdsWithUpdatedFamilyAttributesListQuery:
        arguments:
            - '@database_connection'
            - '@Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Structure\GetFamiliesWithUpdatedAttributesListQuery'
            - '@Akeneo\Pim\Automation\DataQualityInsights\Application\ProductModelIdFactory'

    akeneo.pim.automation.data_quality_insights.query.get_product_ids_with_outdated_attribute_option_spellcheck:
        class: Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\ProductEvaluation\GetProductIdsWithOutdatedAttributeOptionSpellcheckQuery
        arguments:
            - '@akeneo.pim.automation.data_quality_insights.query.get_product_ids_by_attribute_option_code'
            - '@Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Structure\GetAttributeOptionSpellcheckQuery'
            - '@akeneo.pim.automation.data_quality_insights.query.filter_product_ids_with_criterion_not_evaluated_since'
            - '@Akeneo\Pim\Automation\DataQualityInsights\Application\ProductIdFactory'

    akeneo.pim.automation.data_quality_insights.query.get_product_model_ids_with_outdated_attribute_option_spellcheck:
        class: Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\ProductEvaluation\GetProductIdsWithOutdatedAttributeOptionSpellcheckQuery
        arguments:
            - '@akeneo.pim.automation.data_quality_insights.query.get_product_model_ids_by_attribute_option_code'
            - '@Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Structure\GetAttributeOptionSpellcheckQuery'
            - '@akeneo.pim.automation.data_quality_insights.query.filter_product_model_ids_with_criterion_not_evaluated_since'
            - '@Akeneo\Pim\Automation\DataQualityInsights\Application\ProductModelIdFactory'

    akeneo.pim.automation.data_quality_insights.query.filter_product_ids_with_criterion_not_evaluated_since:
        class: Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\ProductEvaluation\FilterProductIdsWithCriterionNotEvaluatedSinceQuery
        arguments:
            - '@database_connection'
            - '%akeneo.pim.automation.data_quality_insights.persistence.product_criterion_evaluation_table%'
            - '@Akeneo\Pim\Automation\DataQualityInsights\Application\ProductIdFactory'

    akeneo.pim.automation.data_quality_insights.query.filter_product_model_ids_with_criterion_not_evaluated_since:
        class: Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\ProductEvaluation\FilterProductIdsWithCriterionNotEvaluatedSinceQuery
        arguments:
            - '@database_connection'
            - '%akeneo.pim.automation.data_quality_insights.persistence.product_model_criterion_evaluation_table%'
            - '@Akeneo\Pim\Automation\DataQualityInsights\Application\ProductModelIdFactory'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Structure\GetAttributeQuery:
        arguments:
            - '@database_connection'

    akeneo.pim.automation.data_quality_insights.query.compute_products_spelling_status_query:
        class: Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\KeyIndicator\ComputeProductsSpellingStatusQuery
        arguments:
            - '@Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\ProductEvaluation\GetEvaluationRatesByProductsAndCriterionQuery'
        tags:
            - { name: akeneo.pim.automation.data_quality_insights.compute_product_key_indicator, feature: 'data_quality_insights_all_criteria' }

    akeneo.pim.automation.data_quality_insights.query.compute_product_models_spelling_status_query:
        class: Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\KeyIndicator\ComputeProductsSpellingStatusQuery
        arguments:
            - '@Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\ProductEvaluation\GetEvaluationRatesByProductModelsAndCriterionQuery'
        tags:
            - { name: akeneo.pim.automation.data_quality_insights.compute_product_model_key_indicator, feature: 'data_quality_insights_all_criteria' }

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\KeyIndicator\ComputeAttributesWithPerfectSpellingQuery:
        arguments:
            - '@database_connection'
            - '@Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Elasticsearch\Query\GetFamiliesByCategoryCodesQuery'
            - '@pim_catalog.repository.category'

    akeneo.pim.automation.data_quality_insights.query.product.get_enrichment_images_masks.community:
        class: Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Completeness\GetAttributeTypesMasksQuery
        arguments:
            $connection: '@database_connection'
            $attributeTypes:
                - !php/const Akeneo\Pim\Structure\Component\AttributeTypes::IMAGE
                - !php/const Akeneo\Pim\Structure\Component\AttributeTypes::ASSET_COLLECTION
                - !php/const Akeneo\Pim\Structure\Component\AttributeTypes::LEGACY_ASSET_COLLECTION

    akeneo.pim.automation.data_quality_insights.query.product.get_enrichment_images_masks:
        class: Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Completeness\GetImageAndImageAssetAttributesMasks
        arguments:
            - '@akeneo.pim.automation.data_quality_insights.query.product.get_enrichment_images_masks.community'
            - '@akeneo.pim.automation.data_quality_insights.query.get_enrichment_images_masks.filter'

    akeneo.pim.automation.data_quality_insights.query.product_model.get_enrichment_images_masks:
        class: Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Completeness\GetAttributeTypesProductModelMasksWithAssetsQuery
        arguments:
            - '@akeneo.pim.automation.data_quality_insights.query.product_model.get_enrichment_images_masks.community'
            - '@akeneo.pim.automation.data_quality_insights.query.get_enrichment_images_masks.filter'

    akeneo.pim.automation.data_quality_insights.query.product_model.get_enrichment_images_masks.community:
        class: Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Completeness\GetAttributeTypesProductModelMasksQuery
        arguments:
            $connection: '@database_connection'
            $attributeTypes:
                - !php/const Akeneo\Pim\Structure\Component\AttributeTypes::IMAGE
                - !php/const Akeneo\Pim\Structure\Component\AttributeTypes::ASSET_COLLECTION
                - !php/const Akeneo\Pim\Structure\Component\AttributeTypes::LEGACY_ASSET_COLLECTION

    akeneo.pim.automation.data_quality_insights.query.get_enrichment_images_masks.filter:
        class: Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Completeness\FilterImageAndImageAssetAttributes
        arguments:
            - '@akeneo_assetmanager.infrastructure.persistence.query.platform.get_asset_attribute_with_media_info_public_api'
            - '@Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Structure\GetProductAssetAndAttributesInfo'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Structure\GetProductAssetAndAttributesInfo:
        arguments:
            - '@database_connection'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Structure\GetActivatedFamilyAttributesCodesQuery:
        arguments:
            - '@database_connection'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Structure\GetFamilyIdsToEvaluateQuery:
        arguments:
            - '@database_connection'

    akeneo.pimee.automation.data_quality_insights.query.get_product_criteria_evaluations:
        class: Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\ProductEvaluation\PimEnterpriseGetCriteriaEvaluationsByProductIdQuery
        decorates: akeneo.pim.automation.data_quality_insights.query.get_product_criteria_evaluations
        decoration_inner_name: akeneo.pim.automation.data_quality_insights.query.get_product_criteria_evaluations.community
        arguments:
            - '@database_connection'
            - '@akeneo.pim.automation.data_quality_insights.query.get_product_criteria_evaluations.community'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Dictionary\GetNumberOfWordsQuery:
        arguments:
            $connection: '@database_connection'

    Akeneo\Pim\Automation\DataQualityInsights\Infrastructure\Persistence\Query\Completeness\AddTableAttributeCase:
        tags:
            - { name: akeneo.pim.automation.data_quality_insights.completeness.add_attribute_case }
