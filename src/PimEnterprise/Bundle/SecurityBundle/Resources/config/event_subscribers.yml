parameters:
    pimee_security.event_subscriber.enrich.disable_product_value_form.class: PimEnterprise\Bundle\SecurityBundle\EventSubscriber\Enrich\DisableProductValueFieldSubscriber
    pimee_security.event_subscriber.enrich.product.class:                    PimEnterprise\Bundle\SecurityBundle\EventSubscriber\Enrich\ProductSubscriber
    pimee_security.event_subscriber.enrich.job_permissions.class:            PimEnterprise\Bundle\SecurityBundle\EventSubscriber\Enrich\JobPermissionsSubscriber
    pimee_security.event_subscriber.enrich.add_owner_groups_parameter.class: PimEnterprise\Bundle\SecurityBundle\EventSubscriber\Enrich\AddOwnerGroupsParameterSubscriber
    pimee_security.event_subscriber.enrich.add_category_permissions.class:   PimEnterprise\Bundle\SecurityBundle\EventSubscriber\Enrich\AddCategoryPermissionsSubscriber
    pimee_security.event_subscriber.enrich.add_default_user_group.class:     PimEnterprise\Bundle\SecurityBundle\EventSubscriber\Enrich\AddDefaultUserGroupSubscriber
    pimee_security.event_subscriber.import_export.add_category_permissions.class:   PimEnterprise\Bundle\SecurityBundle\EventSubscriber\ImportExport\AddCategoryPermissionsSubscriber

services:
    pimee_security.event_subscriber.enrich.disable_product_value_form:
        class: %pimee_security.event_subscriber.enrich.disable_product_value_form.class%
        arguments:
            - '@security.authorization_checker'
        tags:
            - { name: kernel.event_subscriber }

    pimee_security.event_subscriber.enrich.product:
        class: %pimee_security.event_subscriber.enrich.product.class%
        arguments:
            - '@security.authorization_checker'
            - '@pim_user.context.user'
        tags:
            - { name: kernel.event_subscriber }

    pimee_security.event_subscriber.enrich.job_permissions:
        class: %pimee_security.event_subscriber.enrich.job_permissions.class%
        arguments:
            - '@security.authorization_checker'
        tags:
            - { name: kernel.event_subscriber }

    pimee_security.event_subscriber.enrich.add_owner_groups_parameter:
        class: %pimee_security.event_subscriber.enrich.add_owner_groups_parameter.class%
        arguments:
            - '@pimee_security.repository.category_access'
            - '@pim_user.context.user'
        tags:
            - { name: kernel.event_subscriber }

    pimee_security.event_subscriber.enrich.add_category_permissions:
        class: %pimee_security.event_subscriber.enrich.add_category_permissions.class%
        arguments:
            - '@pimee_security.manager.category_access'
        tags:
            - { name: kernel.event_subscriber }

    pimee_security.event_subscriber.import_export.add_category_permissions:
        class: %pimee_security.event_subscriber.import_export.add_category_permissions.class%
        arguments:
            - '@pimee_security.manager.category_access'
        tags:
            - { name: doctrine.event_subscriber }

    pimee_security.event_subscriber.enrich.add_default_user_group:
        class: %pimee_security.event_subscriber.enrich.add_default_user_group.class%
        arguments:
            - '@pim_user.repository.group'
            - '@pimee_security.manager.category_access'
            - '@pimee_security.manager.attribute_group_access'
        tags:
            - { name: kernel.event_subscriber }
