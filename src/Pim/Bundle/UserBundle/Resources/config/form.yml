parameters:
    # Subscribers
    pim_user.form.subscriber.change_password.class:  Pim\Bundle\UserBundle\Form\Subscriber\ChangePasswordSubscriber
    pim_user.form.subscriber.user_preferences.class: Pim\Bundle\UserBundle\Form\Subscriber\UserPreferencesSubscriber
    pim_user.form.subscriber.patch.class:            Pim\Bundle\UserBundle\Form\Subscriber\PatchSubscriber
    pim_user.form.subscriber.user.class:             Pim\Bundle\UserBundle\Form\Subscriber\UserSubscriber
    pim_user.form.subscriber.default_view.class:     Pim\Bundle\UserBundle\Form\Subscriber\DefaultViewSubscriber

    # transformers
    pim_user.form.transformer.default_view.class: Pim\Bundle\UserBundle\Form\Transformer\DefaultViewDataTransformer

    # Types
    pim_user.form.type.user.class:                      Pim\Bundle\UserBundle\Form\Type\UserType
    pim_user.form.type.acl_access_level_selector.class: Pim\Bundle\UserBundle\Form\Type\AclAccessLevelSelectorType
    pim_user.form.type.reset.class:                     Pim\Bundle\UserBundle\Form\Type\ResetType
    pim_user.form.type.group.class:                     Pim\Bundle\UserBundle\Form\Type\GroupType
    pim_user.form.type.group.api.class:                 Pim\Bundle\UserBundle\Form\Type\GroupApiType
    pim_user.form.type.change_password.class:           Pim\Bundle\UserBundle\Form\Type\ChangePasswordType
    pim_user.form.type.acl_role.class:                  Pim\Bundle\UserBundle\Form\Type\AclRoleType

services:

    # Subscribers

    pim_user.form.subscriber.change_password:
        class: %pim_user.form.subscriber.change_password.class%
        arguments:
            - '@security.token_storage'

    pim_user.form.subscriber.user_preferences:
        class: %pim_user.form.subscriber.user_preferences.class%
        arguments:
            - '@pim_localization.provider.ui_locale'
            - %pim_catalog.entity.category.class%

    pim_user.form.subscriber.patch:
        class: %pim_user.form.subscriber.patch.class%
        arguments:
            - '@form.factory'

    pim_user.form.subscriber.user:
        class: %pim_user.form.subscriber.user.class%
        arguments:
            - '@form.factory'
            - '@security.token_storage'

    pim_user.form.subscriber.default_view:
        class: %pim_user.form.subscriber.default_view.class%
        arguments:
            - '@pim_datagrid.repository.datagrid_view'

    # Transformers

    pim_user.form.transformer.default_view:
        class: %pim_user.form.transformer.default_view.class%
        arguments:
            - '@pim_datagrid.repository.datagrid_view'

    # Types

    pim_user.form.type.acl_access_level_selector:
        class: %pim_user.form.type.acl_access_level_selector.class%
        tags:
            - { name: form.type, alias: pim_acl_access_level_selector }

    pim_user.form.type.user:
        scope: request
        class: %pim_user.form.type.user.class%
        arguments:
            - '@request'
            - ['@pim_user.form.subscriber.user_preferences', '@pim_user.form.subscriber.user', '@pim_user.form.subscriber.default_view']
            - ['@pim_user.form.transformer.default_view']
            - '@pim_user.repository.role'
            - '@pim_user.repository.group'
        tags:
            - { name: form.type, alias: pim_user_user }

    pim_user.form.type.change_password:
        class: %pim_user.form.type.change_password.class%
        arguments:
            - '@pim_user.form.subscriber.change_password'
        tags:
             - { name: form.type, alias: oro_change_password }

    pim_user.form.type.group:
        class: %pim_user.form.type.group.class%
        tags:
            - { name: form.type, alias: pim_user_group }

    pim_user.form.type.group.api:
        class: %pim_user.form.type.group.api.class%
        arguments:
            - '@pim_user.form.subscriber.patch'
        tags:
            - { name: form.type, alias: group }

    pim_user.form.type.reset:
        class: %pim_user.form.type.reset.class%
        arguments: [%pim_user.entity.user.class%]
        tags:
            - { name: form.type, alias: pim_user_reset }

    pim_user.form.type.acl_role:
        class: %pim_user.form.type.acl_role.class%
        scope: prototype
        arguments:
            - '@oro_security.acl.manager'
            - %pim_user.privileges%
        tags:
            - { name: form.type, alias: pim_user_role_form }
