parameters:
    pimee_enrich.mass_edit_action.operator.published_product.class: PimEnterprise\Bundle\EnrichBundle\MassEditAction\Operator\PublishedProductMassEditOperator
    pimee_enrich.mass_edit_action.publish.class:                    PimEnterprise\Bundle\EnrichBundle\MassEditAction\Operation\Publish
    pimee_enrich.mass_edit_action.unpublish.class:                  PimEnterprise\Bundle\EnrichBundle\MassEditAction\Operation\Unpublish
    pim_enrich.mass_edit_action.edit_common_attributes.class:       PimEnterprise\Bundle\EnrichBundle\MassEditAction\Operation\EditCommonAttributes
    pim_enrich.mass_edit_action.classify.class:                     PimEnterprise\Bundle\EnrichBundle\MassEditAction\Operation\Classify

    pimee_enrich.mass_edit_handler.update_product_publication.class: PimEnterprise\Bundle\EnrichBundle\MassEditAction\Handler\UpdateProductPublicationHandler

services:
    # Published product operator
    pimee_enrich.mass_edit_action.operator.published_product:
        public: false
        parent: pim_enrich.mass_edit_action.operator
        class: %pimee_enrich.mass_edit_action.operator.published_product.class%
        arguments:
            - '@pimee_workflow.manager.published_product'
        tags:
            - { name: pim_enrich.mass_edit_action_operator, datagrid: published-product-grid }

    # Published products operation
    pimee_enrich.mass_edit_action.unpublish:
        public: false
        class: %pimee_enrich.mass_edit_action.unpublish.class%
        arguments:
            - '@pimee_workflow.manager.published_product'
            - '@security.context'
        tags:
            -
                name: pim_enrich.mass_edit_action
                alias: unpublish
                acl: pimee_workflow_published_product_index
                operator: pimee_enrich.mass_edit_action.operator.published_product

    # New products operations
    pimee_enrich.mass_edit_action.publish:
        public: false
        class: %pimee_enrich.mass_edit_action.publish.class%
        arguments:
            - '@pimee_workflow.manager.published_product'
            - '@security.context'
        tags:
            -
                name: pim_enrich.mass_edit_action
                alias: publish
                acl: pim_enrich_product_edit_attributes
                datagrid: product-grid

    # Overriden products operation to deal with product draft or working copy saving depending on permissions
    pim_enrich.mass_edit_action.edit_common_attributes:
        public: false
        class: %pim_enrich.mass_edit_action.edit_common_attributes.class%
        arguments:
            - '@pim_catalog.builder.product'
            - '@pim_catalog.updater.product'
            - '@pim_user.context.user'
            - '@pim_catalog.context.catalog'
            - '@pim_catalog.manager.product_mass_action'
            - '@pim_serializer'
            - '@pimee_workflow.saver.product_delegating'
            - '@security.context'
        tags:
            -
                name: pim_enrich.mass_edit_action
                alias: edit-common-attributes
                acl: pim_enrich_product_edit_attributes
                datagrid: product-grid

    # Overriden products operation to add permission checks when try to classify products
    pim_enrich.mass_edit_action.classify:
        public: false
        class: %pim_enrich.mass_edit_action.classify.class%
        calls:
            - [setSecurityContext, [ @security.context ]]
        tags:
            -
                name: pim_enrich.mass_edit_action
                alias: classify
                acl: pim_enrich_product_categories_view
                datagrid: product-grid

    pim_enrich.mass_edit_handler.update_product_publication:
        class: %pimee_enrich.mass_edit_handler.update_product_publication.class%
        arguments:
            - '@pim_catalog.query.product_query_builder_factory'
            - '@pimee_workflow.manager.published_product'
            - '@pim_enrich.product.paginator'
