services:
    pimee_versioning.serializer:
        class: '%pim_serializer.class%'

    pimee_versioning.encoder.csv:
        public: false
        class: '%pim_serializer.encoder.csv.class%'
        tags:
            - { name: pimee_versioning.serializer.encoder, priority: 90 }

    pimee_versioning.denormalizer.product:
        class: '%pim_serializer.denormalizer.flat.product.class%'
        arguments:
            - '@akeneo_storage_utils.doctrine.smart_manager_registry'
            - '%pim_catalog.entity.product.class%'
            - '@pim_catalog.builder.product'
            - '@pim_connector.array_converter.flat_to_standard.product.attribute_column_info_extractor'
            - '@pim_connector.array_converter.flat_to_standard.product.association_columns_resolver'
            - '%pim_catalog.entity.association.class%'
            - '%pim_catalog.entity.category.class%'
            - '%pim_catalog.entity.family.class%'
            - '%pim_catalog.entity.group.class%'
            - '%pim_catalog.entity.product_value.class%'
        tags:
            - { name: pimee_versioning.serializer.normalizer, priority: 90 }

    pimee_versioning.denormalizer.family:
        class: '%pim_serializer.denormalizer.flat.family.class%'
        arguments:
            - '@akeneo_storage_utils.doctrine.smart_manager_registry'
            - '%pim_catalog.entity.family.class%'
        tags:
            - { name: pimee_versioning.serializer.normalizer, priority: 90 }

    pimee_versioning.denormalizer.category:
        class: '%pim_serializer.denormalizer.flat.category.class%'
        arguments:
            - '@akeneo_storage_utils.doctrine.smart_manager_registry'
            - '%pim_catalog.entity.category.class%'
        tags:
            - { name: pimee_versioning.serializer.normalizer, priority: 90 }

    pimee_versioning.denormalizer.group:
        class: '%pim_serializer.denormalizer.flat.group.class%'
        arguments:
            - '@akeneo_storage_utils.doctrine.smart_manager_registry'
            - '%pim_catalog.entity.group.class%'
            - '@pim_catalog.repository.group_type'
            - '@pim_catalog.repository.attribute'
        tags:
            - { name: pimee_versioning.serializer.normalizer, priority: 90 }

    pimee_versioning.denormalizer.association:
        class: '%pim_serializer.denormalizer.flat.association.class%'
        arguments:
            - '@akeneo_storage_utils.doctrine.smart_manager_registry'
            - '%pim_catalog.entity.association.class%'
            - '%pim_catalog.entity.association_type.class%'
            - '%pim_catalog.entity.product.class%'
            - '%pim_catalog.entity.group.class%'
        tags:
            - { name: pimee_versioning.serializer.normalizer, priority: 90 }

    pimee_versioning.denormalizer.product_value:
        class: '%pim_serializer.denormalizer.flat.product_value.class%'
        arguments:
            - '@akeneo_storage_utils.doctrine.smart_manager_registry'
            - '%pim_catalog.entity.product_value.class%'
        tags:
            - { name: pimee_versioning.serializer.normalizer, priority: 90 }

    pimee_versioning.denormalizer.base_value:
        class: '%pim_serializer.denormalizer.flat.base_value.class%'
        arguments:
            - ['pim_catalog_identifier', 'pim_catalog_text', 'pim_catalog_textarea', 'pim_catalog_number', 'pim_catalog_boolean']
        tags:
            - { name: pimee_versioning.serializer.normalizer, priority: 90 }

    pimee_versioning.denormalizer.attribute_option:
        class: '%pim_serializer.denormalizer.flat.attribute_option.class%'
        arguments:
            - ['pim_catalog_simpleselect']
            - '@pim_catalog.repository.attribute_option'
        tags:
            - { name: pimee_versioning.serializer.normalizer, priority: 90 }

    pimee_versioning.denormalizer.attribute_options:
        class: '%pim_serializer.denormalizer.flat.attribute_options.class%'
        arguments:
            - ['pim_catalog_multiselect']
            - '@pimee_versioning.denormalizer.attribute_option'
        tags:
            - { name: pimee_versioning.serializer.normalizer, priority: 90 }

    pimee_versioning.denormalizer.prices:
        class: '%pim_serializer.denormalizer.flat.prices.class%'
        arguments:
            - ['pim_catalog_price_collection']
            - '@pim_catalog.builder.product'
        tags:
            - { name: pimee_versioning.serializer.normalizer, priority: 90 }

    pimee_versioning.denormalizer.metric:
        class: '%pim_serializer.denormalizer.flat.metric.class%'
        arguments:
            - ['pim_catalog_metric']
            - '@pim_catalog.factory.metric'
        tags:
            - { name: pimee_versioning.serializer.normalizer, priority: 90 }

    pimee_versioning.denormalizer.datetime:
        class: '%pim_serializer.denormalizer.flat.datetime.class%'
        arguments:
            - ['pim_catalog_date']
        tags:
            - { name: pimee_versioning.serializer.normalizer, priority: 90 }

    pimee_versioning.denormalizer.file:
        class: '%pim_serializer.denormalizer.flat.file.class%'
        arguments:
            - ['pim_catalog_image', 'pim_catalog_file']
            - '@akeneo_file_storage.repository.file_info'
            - '@akeneo_file_storage.file_storage.file.file_storer'
        tags:
            - { name: pimee_versioning.serializer.normalizer, priority: 90 }

    pimee_versioning.denormalizer.reference_data:
        class: '%pim_reference_data.denormalizer.flat.reference_data.class%'
        arguments:
            - ['pim_reference_data_simpleselect']
            - '@?pim_reference_data.repository_resolver'
        tags:
            - { name: pimee_versioning.serializer.normalizer, priority: 90 }

    pimee_versioning.denormalizer.reference_data_collection:
        class: '%pim_reference_data.denormalizer.flat.reference_data_collection.class%'
        arguments:
            - ['pim_reference_data_multiselect', 'pim_assets_collection']
            - '@?pim_reference_data.repository_resolver'
        tags:
            - { name: pimee_versioning.serializer.normalizer, priority: 90 }
