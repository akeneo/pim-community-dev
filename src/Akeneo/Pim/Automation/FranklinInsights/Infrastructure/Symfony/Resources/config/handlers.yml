services:

    # Command Handlers
    akeneo.pim.automation.franklin_insights.application.configuration.command.activate_connection_handler:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\Configuration\Command\ActivateConnectionHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.application.configuration.validator.connection'
            - '@akeneo.pim.automation.franklin_insights.repository.configuration'

    akeneo.pim.automation.franklin_insights.application.configuration.command.deactivate_connection_handler:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\Configuration\Command\DeactivateConnectionHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.repository.configuration'

    akeneo.pim.automation.franklin_insights.handler.update_identifiers_mapping:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\Mapping\Command\SaveIdentifiersMappingHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.repository.attribute'
            - '@akeneo.pim.automation.franklin_insights.repository.identifiers_mapping'
            - '@akeneo.pim.automation.franklin_insights.data_provider.identifiers_mapping'
            - '@akeneo.pim.automation.franklin_insights.repository.product_subscription'
            - '@akeneo.pim.automation.franklin_insights.application.mapping.service.identify_products_to_resubscribe'

    akeneo.pim.automation.franklin_insights.handler.subscribe_product:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\ProductSubscription\Command\SubscribeProductHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.infrastructure.persistence.query.product.select_product_infos_for_subscription'
            - '@akeneo.pim.automation.franklin_insights.handler.get_product_subscription_status'
            - '@akeneo.pim.automation.franklin_insights.repository.product_subscription'
            - '@akeneo.pim.automation.franklin_insights.data_provider.product_subscription'
            - '@akeneo.pim.automation.franklin_insights.handler.create_proposal'
            - '@event_dispatcher'

    akeneo.pim.automation.franklin_insights.product_subscription.handler.unsubscribe_product:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\ProductSubscription\Command\UnsubscribeProductHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.repository.product_subscription'
            - '@akeneo.pim.automation.franklin_insights.data_provider.product_subscription'
            - '@event_dispatcher'

    akeneo.pim.automation.franklin_insights.product_subscription.handler.update_subscription_family:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\ProductSubscription\Command\UpdateSubscriptionFamilyHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.repository.product_subscription'
            - '@akeneo.pim.automation.franklin_insights.data_provider.product_subscription'
            - '@akeneo.pim.automation.franklin_insights.repository.family'

    akeneo.pim.automation.franklin_insights.handler.create_proposal:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\Proposal\Command\CreateProposalHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.proposal.factory.suggested_data'
            - '@akeneo.pim.automation.franklin_insights.proposal.create_proposal'
            - '@akeneo.pim.automation.franklin_insights.repository.product_subscription'

    akeneo.pim.automation.franklin_insights.handler.update_attributes_mapping_by_family:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\Mapping\Command\SaveAttributesMappingByFamilyHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.repository.family'
            - '@akeneo.pim.automation.franklin_insights.repository.attribute'
            - '@akeneo.pim.automation.franklin_insights.data_provider.attributes_mapping'
            - '@akeneo.pim.automation.franklin_insights.repository.product_subscription'
            - '@akeneo.pim.automation.franklin_insights.infrastructure.persistence.query.select_family_attribute_codes'
            - '@akeneo.pim.automation.franklin_insights.connector.job_launcher.schedule_fetch_products'

    akeneo.pim.automation.franklin_insights.handler.save_attribute_options_mapping:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\Mapping\Command\SaveAttributeOptionsMappingHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.data_provider.attribute_options_mapping'
            - '@akeneo.pim.automation.franklin_insights.repository.family'
            - '@akeneo.pim.automation.franklin_insights.repository.attribute'
            - '@akeneo.pim.automation.franklin_insights.infrastructure.persistence.query.select_attribute_option_codes_by_identifiers'

    # Query Handlers
    akeneo.pim.automation.franklin_insights.handler.get_product_subscription_status:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\ProductSubscription\Query\GetProductSubscriptionStatusHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.application.configuration.query.get_connection_status_handler'
            - '@akeneo.pim.automation.franklin_insights.infrastructure.persistence.query.product.select_product_infos_for_subscription'

    akeneo.pim.automation.franklin_insights.handler.get_attributes_mapping_by_family:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\Mapping\Query\GetAttributesMappingByFamilyHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.data_provider.attributes_mapping'
            - '@akeneo.pim.automation.franklin_insights.repository.family'
            - '@akeneo.pim.automation.franklin_insights.repository.attribute'

    akeneo.pim.automation.franklin_insights.handler.get_attribute_options_mapping_by_family_and_attribute:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\Mapping\Query\GetAttributeOptionsMappingHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.data_provider.attribute_options_mapping'
            - '@akeneo.pim.automation.franklin_insights.repository.family'

    akeneo.pim.automation.franklin_insights.handler.get_families:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\Mapping\Query\SearchFamiliesHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.repository.family_mapping_status'

    akeneo.pim.automation.franklin_insights.application.configuration.query.get_connection_status_handler:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\Configuration\Query\GetConnectionStatusHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.repository.configuration'
            - '@akeneo.pim.automation.franklin_insights.data_provider.authentication'
            - '@akeneo.pim.automation.franklin_insights.repository.identifiers_mapping'
            - '@akeneo.pim.automation.franklin_insights.repository.product_subscription'

    akeneo.pim.automation.franklin_insights.application.configuration.query.get_connection_is_active_handler:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\Configuration\Query\GetConnectionIsActiveHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.repository.cache.configuration'

    akeneo.pim.automation.franklin_insights.application.configuration.query.get_configuration_handler:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\Configuration\Query\GetConfigurationHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.repository.configuration'

    akeneo.pim.automation.franklin_insights.handler.get_identifiers_mapping:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\Mapping\Query\GetIdentifiersMappingHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.repository.identifiers_mapping'

    akeneo.pim.automation.franklin_insights.handler.get_attribute_mapping_with_suggestions:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\Mapping\Query\GetAttributesMappingWithSuggestionsHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.handler.get_attributes_mapping_by_family'
            - '@akeneo.pim.automation.franklin_insights.application.mapping.service.data_processor.apply_attribute_exact_matches'
            - '@akeneo.pim.automation.franklin_insights.application.mapping.service.data_processor.suggest_attribute_exact_matches_from_other_family'

    akeneo.pim.automation.franklin_insights.handler.create_attribute_in_family:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\Structure\Command\CreateAttributeInFamilyHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.application.structure.service.create_attribute'
            - '@akeneo.pim.automation.franklin_insights.repository.franklin_attribute_created'
            - '@akeneo.pim.automation.franklin_insights.handler.add_attribute_to_family'

    akeneo.pim.automation.franklin_insights.handler.add_attribute_to_family:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\Structure\Command\AddAttributeToFamilyHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.application.structure.service.add_attribute_to_family'
            - '@akeneo.pim.automation.franklin_insights.repository.franklin_attribute_added_to_family'

    akeneo.pim.automation.franklin_insights.handler.bulk_create_attributes_in_family:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\Structure\Command\BulkCreateAttributesInFamilyHandler'
        arguments:
          - '@akeneo.pim.automation.franklin_insights.application.structure.service.create_attribute'
          - '@akeneo.pim.automation.franklin_insights.application.structure.service.add_attribute_to_family'
          - '@akeneo.pim.automation.franklin_insights.repository.franklin_attribute_created'
          - '@akeneo.pim.automation.franklin_insights.repository.franklin_attribute_added_to_family'

    akeneo.pim.automation.franklin_insights.handler.bulk_add_attributes_to_family:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\Structure\Command\BulkAddAttributesToFamilyHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.application.structure.service.add_attribute_to_family'
            - '@akeneo.pim.automation.franklin_insights.repository.franklin_attribute_added_to_family'

    akeneo.pim.automation.franklin_insights.handler.get_key_measurements:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\KeyFigure\Query\GetKeyFiguresHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.repository.franklin_attribute_created'
            - '@akeneo.pim.automation.franklin_insights.repository.franklin_attribute_added_to_family'

    akeneo.pim.automation.franklin_insights.handler.get_ask_franklin_credits:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Application\KeyFigure\Query\GetCreditsHandler'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.data_provider.statistics'
