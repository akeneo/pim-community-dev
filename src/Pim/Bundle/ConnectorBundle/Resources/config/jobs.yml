parameters: ~

services:
    pim_connector.job.csv_group_import:
        class: %akeneo_batch.job.class%
        arguments:
            - 'pim_connector.jobs.csv_product_import.title'
        tags:
            - { name: 'akeneo_batch.job', job_alias: 'csv_group_import', job_type: 'import', connector: 'Akeneo CSV Connector'}
        calls:
            - [ setJobRepository, [@akeneo_batch.job_repository]]
            - [ setEventDispatcher, [@event_dispatcher]]
            - [ setSteps, [[@pim_connector.step.validator, @pim_connector.step.csv_group_import]]]

    pim_connector.step.validator:
        class: %pim_connector.step.validator.class%
        arguments:
            - 'pim_base_connector.jobs.csv_group_import.validation.title'
        calls:
            - [ setJobRepository, [@akeneo_batch.job_repository]]
            - [ setEventDispatcher, [@event_dispatcher]]
            - [ setCharsetValidator, [@pim_connector.validator.item.charset_validator]]

    pim_connector.step.csv_group_import:
        class: %akeneo_batch.step.item_step.class%
        arguments:
            - 'pim_connector.jobs.csv_group_import.import.title'
        calls:
            - [ setJobRepository, [@akeneo_batch.job_repository]]
            - [ setEventDispatcher, [@event_dispatcher]]
            - [ setReader, [@pim_connector.reader.file.csv_group]]
            - [ setProcessor, [@pim_connector.processor.denormalization.group.flat]]
            - [ setWriter, [@pim_connector.writer.doctrine.group]]
