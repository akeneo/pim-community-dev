parameters:
    pimee_catalog.security.saver.filtered_entity.class: PimEnterprise\Bundle\CatalogBundle\Security\Doctrine\Common\Saver\FilteredEntitySaver

services:
    pimee_catalog.security.saver.product:
        class: '%pimee_catalog.security.saver.filtered_entity.class%'
        decorates: pim_catalog.saver.product
        decoration_inner_name: pim_catalog.saver.product_without_permission
        arguments:
            - '@pim_catalog.saver.product_without_permission'
            - '@pim_catalog.saver.product_without_permission'
            - '@pimee_catalog.security.merger.merge_data_on_product'
            - '@pim_catalog.repository.product_without_permission'

    pimee_catalog.security.saver.product_model:
        class: '%pimee_catalog.security.saver.filtered_entity.class%'
        decorates: pim_catalog.saver.product_model
        decoration_inner_name: pim_catalog.saver.product_model_without_permission
        arguments:
            - '@pim_catalog.saver.product_model_without_permission'
            - '@pim_catalog.saver.product_model_without_permission'
            - '@pimee_catalog.security.merger.merge_data_on_product_model'
            - '@pim_catalog.repository.product_model_without_permission'

    pim_catalog.saver.product_model_descendants:
        class: '%pim_catalog.saver.product_model_descendants.class%'
        arguments:
            - '@doctrine.orm.entity_manager'
            - '@pim_catalog.repository.product_model'
            - '@pim_catalog.query.product_query_builder_factory_without_permission'
            - '@pim_catalog.manager.completeness'
            - '@pim_catalog.elasticsearch.indexer.product'
            - '@pim_catalog.elasticsearch.indexer.product_model'
            - '@pim_catalog.elasticsearch.indexer.product_model'
