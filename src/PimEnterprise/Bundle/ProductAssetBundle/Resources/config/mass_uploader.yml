parameters:
    pimee_product_asset.upload_checker.class:        PimEnterprise\Component\ProductAsset\Upload\UploadChecker
    pimee_product_asset.upload_importer.class:       PimEnterprise\Component\ProductAsset\Upload\Importer
    pimee_product_asset.mass_upload_processor.class: PimEnterprise\Component\ProductAsset\Upload\MassUpload\MassUploadProcessor
    pimee_product_asset.mass_upload.tasklet.class:   PimEnterprise\Bundle\ProductAssetBundle\MassUpload\MassUploadTasklet

services:
    pimee_product_asset.upload_checker:
        class: '%pimee_product_asset.upload_checker.class%'
        arguments:
            - '@pimee_product_asset.repository.asset'
            - '@pim_catalog.repository.locale'

    pimee_product_asset.upload_importer:
        class: '%pimee_product_asset.upload_importer.class%'
        arguments:
            - '@pimee_product_asset.upload_checker'
            - '@akeneo_file_storage.file_storage.file.file_storer'

    pimee_product_asset.mass_upload.builder.asset:
        class: 'PimEnterprise\Component\ProductAsset\Upload\MassUpload\AssetBuilder'
        arguments:
            - '@pimee_product_asset.upload_checker'
            - '@pimee_product_asset.factory.asset'
            - '@pimee_product_asset.repository.asset'
            - '@pimee_product_asset.updater.files'
            - '@akeneo_file_storage.file_storage.file.file_storer'
            - '@pim_catalog.repository.locale'

    pimee_product_asset.mass_upload.retrieve_asset_generation_errors:
        class: 'PimEnterprise\Component\ProductAsset\Upload\MassUpload\RetrieveAssetGenerationErrors'
        arguments:
            - '@translator'

    pimee_product_asset.mass_upload.add_asset_to_product:
        class: 'PimEnterprise\Component\ProductAsset\Upload\MassUpload\AddAssetToEntityWithValues'
        arguments:
            - '@pimee_workflow.repository.delegating_product'
            - '@pim_catalog.updater.product'
            - '@pim_catalog.validator.product'
            - '@pimee_workflow.saver.product_delegating'

    pimee_product_asset.mass_upload.add_asset_to_product_model:
        class: 'PimEnterprise\Component\ProductAsset\Upload\MassUpload\AddAssetToEntityWithValues'
        arguments:
            - '@pimee_workflow.repository.delegating_product_model'
            - '@pim_catalog.updater.product_model'
            - '@pim_catalog.validator.product_model'
            - '@pimee_workflow.saver.product_model_delegating'

    pimee_product_asset.mass_upload_processor:
        class: '%pimee_product_asset.mass_upload_processor.class%'
        arguments:
            - '@pimee_product_asset.upload_importer'
            - '@pimee_product_asset.mass_upload.builder.asset'
            - '@pimee_product_asset.saver.asset'
            - '@event_dispatcher'
            - '@pimee_product_asset.mass_upload.retrieve_asset_generation_errors'
            - '@akeneo_storage_utils.doctrine.object_detacher'

    pimee_product_asset.mass_upload.processor.into_product:
        class: 'PimEnterprise\Component\ProductAsset\Upload\MassUpload\MassUploadIntoAssetCollectionProcessor'
        arguments:
            - '@pimee_product_asset.upload_importer'
            - '@pimee_product_asset.mass_upload.builder.asset'
            - '@pimee_product_asset.saver.asset'
            - '@event_dispatcher'
            - '@pimee_product_asset.mass_upload.retrieve_asset_generation_errors'
            - '@akeneo_storage_utils.doctrine.object_detacher'
            - '@pimee_product_asset.mass_upload.add_asset_to_product'

    pimee_product_asset.mass_upload.processor.into_product_model:
        class: 'PimEnterprise\Component\ProductAsset\Upload\MassUpload\MassUploadIntoAssetCollectionProcessor'
        arguments:
            - '@pimee_product_asset.upload_importer'
            - '@pimee_product_asset.mass_upload.builder.asset'
            - '@pimee_product_asset.saver.asset'
            - '@event_dispatcher'
            - '@pimee_product_asset.mass_upload.retrieve_asset_generation_errors'
            - '@akeneo_storage_utils.doctrine.object_detacher'
            - '@pimee_product_asset.mass_upload.add_asset_to_product_model'

    pimee_product_asset.mass_upload.tasklet:
        class: '%pimee_product_asset.mass_upload.tasklet.class%'
        arguments:
            - '@pimee_product_asset.mass_upload_processor'
            - '%tmp_storage_dir%'

    pimee_product_asset.tasklet.mass_upload_into_asset_collection:
        class: 'PimEnterprise\Bundle\ProductAssetBundle\MassUpload\MassUploadIntoAssetCollectionTasklet'
        arguments:
            - '@pimee_product_asset.mass_upload.processor.into_product'
            - '@pimee_product_asset.mass_upload.processor.into_product_model'
            - '%tmp_storage_dir%'
