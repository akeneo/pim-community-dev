parameters:
    pimee_workflow.normalizer.product_draft.class:     Akeneo\Pim\WorkOrganization\Workflow\Bundle\Normalizer\ProductDraftNormalizer
    pimee_workflow.normalizer.published_product.class: Akeneo\Pim\WorkOrganization\Workflow\Bundle\Normalizer\PublishedProductNormalizer
    pimee_workflow.normalizer.proposal_product.class: Akeneo\Pim\WorkOrganization\Workflow\Bundle\Datagrid\Normalizer\ProductProposalNormalizer
    pimee_workflow.normalizer.proposal_product_model.class: Akeneo\Pim\WorkOrganization\Workflow\Bundle\Datagrid\Normalizer\ProductModelProposalNormalizer
    pimee_workflow.normalizer.published_product_version.class: Akeneo\Pim\WorkOrganization\Workflow\Bundle\Versioning\VersionNormalizer

services:
    pimee_workflow.normalizer.product_draft:
        class: '%pimee_workflow.normalizer.product_draft.class%'
        tags:
            - { name: pim_internal_api_serializer.normalizer, priority: 120 }

    pimee_workflow.normalizer.published_product:
        class: '%pimee_workflow.normalizer.published_product.class%'
        arguments:
            - '@pim_catalog.normalizer.standard.product.properties'
            - '@pimee_workflow.normalizer.standard.published_product.associations'
        tags:
            - { name: pim_standard_format_serializer.normalizer, priority: 130 }

    pimee_workflow.normalizer.proposal_product:
        class: '%pimee_workflow.normalizer.proposal_product.class%'
        arguments:
            - '@pim_standard_format_serializer'
            - '@pim_datagrid_serializer'
            - '@pim_catalog.factory.value'
            - '@pim_catalog.repository.cached_attribute'
        tags:
            - { name: pim_datagrid_serializer.normalizer }
        lazy: true

    pimee_workflow.normalizer.proposal_product_model:
        class: '%pimee_workflow.normalizer.proposal_product_model.class%'
        arguments:
            - '@pim_standard_format_serializer'
            - '@pim_datagrid_serializer'
            - '@pim_catalog.factory.value'
            - '@pim_catalog.repository.cached_attribute'
        tags:
            - { name: pim_datagrid_serializer.normalizer }
        lazy: true

    pimee_enrich.normalizer.published_product:
        class: 'Akeneo\Pim\WorkOrganization\Workflow\Component\Normalizer\InternalApi\PublishedProductNormalizer'
        arguments:
            - '@pimee_enrich.normalizer.product'
        tags:
            - { name: pim_internal_api_serializer.normalizer, priority: 130 }

    pimee_workflow.normalizer.standard.published_product:
        class: '%pim_catalog.normalizer.standard.product.class%'
        arguments:
            - '@pim_catalog.normalizer.standard.product.properties'
            - '@pimee_workflow.normalizer.standard.published_product.associations'
        tags:
            - { name: pim_serializer.normalizer, priority: 90 }

    pimee_workflow.normalizer.standard.published_product.associations:
        class: '%pim_catalog.normalizer.standard.product.associations.class%'
        arguments:
            - '@pimee_workflow.query.get_associated_product_codes_by_published_product'
        tags:
            - { name: pim_serializer.normalizer, priority: 40 }

    # Versioning
    pimee_workflow.normalizer.published_product_version:
        class: '%pimee_workflow.normalizer.published_product_version.class%'
        arguments:
            - '@pim_enrich.normalizer.version'
            - '@pimee_workflow.repository.published_product'
        tags:
            - { name: pim_internal_api_serializer.normalizer, priority: 120 }

    pimee_enrich.normalizer.product:
        class: 'Akeneo\Pim\WorkOrganization\Workflow\Bundle\Normalizer\ProductNormalizer'
        arguments:
            - '@pim_enrich.normalizer.product'
            - '@pimee_workflow.manager.published_product'
            - '@pimee_workflow.repository.product_draft'
            - '@pimee_workflow.applier.draft'
            - '@pimee_security.repository.category_access'
            - '@security.token_storage'
            - '@security.authorization_checker'
            - '@pim_catalog.repository.product'
        tags:
            - { name: pim_internal_api_serializer.normalizer, priority: 120 }

    pimee_enrich.normalizer.product_model:
        class: 'Akeneo\Pim\WorkOrganization\Workflow\Bundle\Normalizer\ProductModelNormalizer'
        arguments:
            - '@pim_enrich.normalizer.product_model'
            - '@pimee_workflow.repository.product_model_draft'
            - '@pimee_workflow.applier.draft'
            - '@pimee_security.repository.category_access'
            - '@security.token_storage'
            - '@security.authorization_checker'
            - '@pim_catalog.repository.product_model'
        tags:
            - { name: pim_internal_api_serializer.normalizer, priority: 120 }

    pimee_workflow.normalizer.user:
        class: 'Akeneo\Pim\WorkOrganization\Workflow\Component\Normalizer\InternalApi\UserNormalizer'
        arguments:
            $categoryAccessRepository: '@pimee_security.repository.category_access'
            $getAllEditableCategoryCodes: '@akeneo.pim.enrichment.category.get_editable_category_codes'
            $getAllOwnableCategoryCodes: '@akeneo.pim.enrichment.category.get_ownable_category_codes'
