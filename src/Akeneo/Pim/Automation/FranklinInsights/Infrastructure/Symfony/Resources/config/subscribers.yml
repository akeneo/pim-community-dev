services:
    akeneo.pim.automation.franklin_insights.subscriber.product_family_update:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Subscriber\Product\ProductFamilyUpdateSubscriber'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.infrastructure.persistence.query.product.select_product_family_id_query'
            - '@akeneo.pim.automation.franklin_insights.product_subscription.handler.unsubscribe_product'
            - '@akeneo.pim.automation.franklin_insights.product_subscription.handler.update_subscription_family'
            - '@akeneo.pim.automation.franklin_insights.application.configuration.query.get_connection_is_active_handler'
        tags:
            - { name: kernel.event_subscriber }

    akeneo.pim.automation.franklin_insights.subscriber.product_to_variant_product:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Subscriber\Product\ProductToVariantProductSubscriber'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.product_subscription.handler.unsubscribe_product'
            - '@akeneo.pim.automation.franklin_insights.application.configuration.query.get_connection_is_active_handler'
        tags:
            - { name: kernel.event_subscriber }

    akeneo.pim.automation.franklin_insights.subscriber.remove_attribute_from_mapping:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Subscriber\Attribute\AttributeRemoveSubscriber'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.infrastructure.persistence.query.select_family_codes_by_attribute_query'
            - '@akeneo.pim.automation.franklin_insights.application.mapping.service.remove_attributes_from_mapping'
            - '@akeneo.pim.automation.franklin_insights.application.configuration.query.get_connection_is_active_handler'
            - '@akeneo.pim.automation.franklin_insights.repository.identifiers_mapping'
            - '@akeneo.pim.automation.franklin_insights.handler.update_identifiers_mapping'
        tags:
            - { name: kernel.event_subscriber }

    akeneo.pim.automation.franklin_insights.subscriber.remove_option_from_attribute_option_mapping:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Subscriber\AttributeOption\AttributeOptionRemoveSubscriber'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.application.mapping.service.remove_option_from_attribute_options_mapping'
            - '@akeneo.pim.automation.franklin_insights.application.configuration.query.get_connection_is_active_handler'
        tags:
            - { name: kernel.event_subscriber }

    akeneo.pim.automation.franklin_insights.subscriber.family:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Subscriber\Family\FamilyAttributesRemoveSubscriber'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.infrastructure.persistence.query.find_family_attributes_not_in'
            - '@akeneo.pim.automation.franklin_insights.application.mapping.service.remove_attributes_from_mapping'
            - '@akeneo.pim.automation.franklin_insights.application.configuration.query.get_connection_is_active_handler'
        tags:
            - { name: kernel.event_subscriber }

    akeneo.pim.automation.franklin_insights.subscriber.unsubscribe_product_after_product_removal:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Subscriber\Product\ProductRemoveSubscriber'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.product_subscription.handler.unsubscribe_product'
            - '@akeneo.pim.automation.franklin_insights.application.configuration.query.get_connection_is_active_handler'
        tags:
            - { name: kernel.event_subscriber }

    akeneo.pim.automation.franklin_insights.subscriber.channel_update:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Subscriber\Channel\ChannelUpdateSubscriber'
        arguments:
            - '@pim_catalog.repository.locale'
            - '@akeneo.pim.automation.franklin_insights.application.configuration.command.deactivate_connection_handler'
            - '@akeneo.pim.automation.franklin_insights.application.configuration.query.get_connection_is_active_handler'
        tags:
            - { name: kernel.event_subscriber }

    akeneo.pim.automation.franklin_insights.subscriber.product_update:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Subscriber\Product\ProductUpdateSubscriber'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.repository.product_subscription'
            - '@akeneo.pim.automation.franklin_insights.infrastructure.persistence.query.product.select_product_identifier_values_query'
            - '@akeneo.pim.automation.franklin_insights.application.subscription.service.resubscribe_products'
            - '@akeneo.pim.automation.franklin_insights.application.configuration.query.get_connection_is_active_handler'
        tags:
            - { name: kernel.event_subscriber }

    akeneo.pim.automation.franklin_insights.subscriber.subscription:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Subscriber\Subscription\SubscriptionSubscriber'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.elasticsearch.updater.product_subscription'
        tags:
            - { name: kernel.event_subscriber }

    akeneo.pim.automation.franklin_insights.subscriber.invalid_token_exception:
        class: 'Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Subscriber\Exception\InvalidTokenExceptionSubscriber'
        arguments:
            - '@akeneo.pim.automation.franklin_insights.notifier.notify_about_invalid_token'
        tags:
            - { name: kernel.event_subscriber }

    akeneo.pim.automation.franklin_insights.subscriber.quality_highlights_attribute_updated:
        class: Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Subscriber\QualityHighlights\Attribute\AttributeUpdatedSubscriber
        arguments:
            - '@akeneo.pim.automation.franklin_insights.application.configuration.query.get_connection_is_active_handler'
            - '@akeneo.pim.automation.franklin_insights.repository.quality_highlights_pending_items'
        tags:
            - { name: kernel.event_subscriber }

    akeneo.pim.automation.franklin_insights.subscriber.quality_highlights_attribute_deleted:
        class: Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Subscriber\QualityHighlights\Attribute\AttributeDeletedSubscriber
        arguments:
            - '@akeneo.pim.automation.franklin_insights.application.configuration.query.get_connection_is_active_handler'
            - '@akeneo.pim.automation.franklin_insights.repository.quality_highlights_pending_items'
        tags:
            - { name: kernel.event_subscriber }

    akeneo.pim.automation.franklin_insights.subscriber.quality_highlights_attribute_option_updated:
        class: Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Subscriber\QualityHighlights\Attribute\AttributeOptionUpdatedSubscriber
        arguments:
            - '@akeneo.pim.automation.franklin_insights.application.configuration.query.get_connection_is_active_handler'
            - '@akeneo.pim.automation.franklin_insights.repository.quality_highlights_pending_items'
        tags:
            - { name: kernel.event_subscriber }

    akeneo.pim.automation.franklin_insights.subscriber.quality_highlights_attribute_option_deleted:
        class: Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Subscriber\QualityHighlights\Attribute\AttributeOptionDeletedSubscriber
        arguments:
            - '@akeneo.pim.automation.franklin_insights.application.configuration.query.get_connection_is_active_handler'
            - '@akeneo.pim.automation.franklin_insights.repository.quality_highlights_pending_items'
        tags:
            - { name: kernel.event_subscriber }

    akeneo.pim.automation.franklin_insights.subscriber.quality_highlights_family_updated:
        class: Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Subscriber\QualityHighlights\Family\FamilyUpdatedSubscriber
        arguments:
            - '@akeneo.pim.automation.franklin_insights.application.configuration.query.get_connection_is_active_handler'
            - '@akeneo.pim.automation.franklin_insights.repository.quality_highlights_pending_items'
        tags:
            - { name: kernel.event_subscriber }

    akeneo.pim.automation.franklin_insights.subscriber.quality_highlights_family_deleted:
        class: Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Subscriber\QualityHighlights\Family\FamilyDeletedSubscriber
        arguments:
            - '@akeneo.pim.automation.franklin_insights.application.configuration.query.get_connection_is_active_handler'
            - '@akeneo.pim.automation.franklin_insights.repository.quality_highlights_pending_items'
        tags:
            - { name: kernel.event_subscriber }

    akeneo.pim.automation.franklin_insights.subscriber.quality_highlights_product_updated:
        class: Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Subscriber\QualityHighlights\Product\ProductUpdatedSubscriber
        arguments:
            - '@akeneo.pim.automation.franklin_insights.application.configuration.query.get_connection_is_active_handler'
            - '@akeneo.pim.automation.franklin_insights.repository.quality_highlights_pending_items'
        tags:
            - { name: kernel.event_subscriber }

    akeneo.pim.automation.franklin_insights.subscriber.quality_highlights_product_deleted:
        class: Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Subscriber\QualityHighlights\Product\ProductDeletedSubscriber
        arguments:
            - '@akeneo.pim.automation.franklin_insights.application.configuration.query.get_connection_is_active_handler'
            - '@akeneo.pim.automation.franklin_insights.repository.quality_highlights_pending_items'
        tags:
            - { name: kernel.event_subscriber }

    Akeneo\Pim\Automation\FranklinInsights\Infrastructure\Subscriber\QualityHighlights\Configuration\ConnectionActivatedSubscriber:
        arguments:
            - '@akeneo.pim.automation.franklin_insights.repository.quality_highlights_pending_items'
        tags:
            - { name: kernel.event_subscriber }
