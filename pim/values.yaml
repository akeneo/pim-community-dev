nameOverride: ""
global:
  extraLabels:
    type: srnt
    pfid: nil
  monitoring:
    enabled: true

backup:
  enabled: true
  projectId: nil
  zone: nil
  snapshot:
    schedule: "0 0 */1 * * *" # Once every hour: https://godoc.org/github.com/robfig/cron
    retentionPolicy:
      dailyBackups: 10
      weeklyBackups: 4
      monthlyBackups: 12
      yearlyBackups: 10
    export:
      enabled: true
      snapshotAge: 24h

common:
  extraLabels: {}
  pimMasterDomain: nil
  retailerDomain: nil
  phpConfFPM:
  - name: "PHP_CONF_MAX_EXECUTION_TIME"
    value: "60"
  - name: "PHP_CONF_UPLOAD_LIMIT"
    value: "512M"
  - name: "PHP_CONF_MAX_POST_SIZE"
    value: "512M"
  - name: "PHP_CONF_MEMORY_LIMIT"
    value: "512M"
  - name: "PHP_CONF_DISPLAY_ERRORS"
    value: "off"
  - name: "PHP_CONF_ERROR_REPORTING"
    value: "22527" # E_ALL & ~E_DEPRECATED & ~E_STRICT
  - name: "PHP_CONF_DATE_TIMEZONE"
    value: "Etc/UTC"

  phpConfCLI:
  - name: "PHP_CONF_MAX_EXECUTION_TIME"
    value: "0"
  - name: "PHP_CONF_UPLOAD_LIMIT"
    value: "512M"
  - name: "PHP_CONF_MAX_POST_SIZE"
    value: "512M"
  - name: "PHP_CONF_MEMORY_LIMIT"
    value: "2G"
  - name: "PHP_CONF_DISPLAY_ERRORS"
    value: "off"
  - name: "PHP_CONF_ERROR_REPORTING"
    value: "22527" # E_ALL & ~E_DEPRECATED & ~E_STRICT
  - name: "PHP_CONF_DATE_TIMEZONE"
    value: "Etc/UTC"

mailer:
  login: nil
  password: nil
  host: nil
  port: nil
  from_address: no-reply@akeneo.com

certmanager:
  issuer: letsencrypt-prod
  acme:
    challenge: dns01
    dns01:
      provider: clouddns

image:
  pim:
    repository: eu.gcr.io/akeneo-cloud/pim-enterprise-cloud
    # image.pim.tag is added by the Jenkinsfile when running the CI, manually use "--set image.pim.tag x.y.z-AB"
    pullPolicy: IfNotPresent
  httpd:
    repository: httpd
    tag: 2.4.33
    pullPolicy: IfNotPresent

pim:
  replicas: 1
  numDaemon: 1
  extravarsPim: {}
  extraLabels: {}
  persistence:
    diskSize: 150Gi
  resources:
    requests:
      cpu: 200m
  defaultCatalog: minimal
  jobs:
    batch-purge:
      enabled: true
      pimCommand: "akeneo:batch:purge-job-execution"
      schedule: "0 0 1 * *"
    completeness-calculate:
      enabled: true
      pimCommand: "pim:completeness:calculate"
      schedule: "0 2 1 * *"
    rule-run:
      enabled: true
      pimCommand: "akeneo:rule:run"
      schedule: "0 */1 * * *"
    versionning-refresh:
      enabled: true
      pimCommand: "pim:versioning:refresh"
      schedule: "0 3 * * *"
    volume-aggregate:
      enabled: true
      pimCommand: "pim:volume:aggregate"
      schedule: "0 4 * * *"
    send-expiration-notification:
      enabled: true
      pimCommand: "pim:asset:send-expiration-notification"
      schedule: "0 1 * * *"
    project-recalculate:
      enabled: true
      pimCommand: "pimee:project:recalculate"
      schedule: "20 0 * * *"
    project-notify-before-due-date:
      enabled: true
      pimCommand: "pimee:project:notify-before-due-date"
      schedule: "0 2 * * *"

# Onboarder
onboarder:
  enabled: false
  pubsub:
    topicPub: nil
    topicCon: nil
    queueName: nil
  serviceAccount: nil
  sso:
    idp:
      publicKey: nil
    sp:
      rawCrt: nil
      rawPem: nil

nfs:
  nameOverride: ""
  persistence:
    enabled: true
    storageClass: ssd-retain
    size: 151Gi # Must be equal to (pim.persistence.diskSize + 1)
  storageClass:
    name: nfs

pimUsers:
  cloudadmin:
    firstName: nil # can be defined by the provider, use "--set pimUsers.cloudadmin.firstName cloud"
    lastName: nil # can be defined by the provider, use "--set pimUsers.cloudadmin.lastName cloud"
    email: nil # can be defined by the provider, use "--set pimUsers.cloudadmin.email cloud"
    password: nil # can be defined by the provider, use "--set pimUsers.cloudadmin.password cloud"
    catalogDefaultLocale: en_US
    userDefaultLocale: en_US
    catalogDefaultScope: ecommerce
    defaultCategoryTree: master
    roles: ROLE_ADMINISTRATOR
    groups: IT support
    enabled: 1
    defaultAssetTree: asset_main_catalog

mysql:
  common:
    class: ssd-retain
  mysql:
    serviceName: pim-mysql
    defaultUser: akeneo_pim
    userPassword: nil # can be defined by the provider, use "--set mysql.mysql.userPassword generateme"
    rootPassword: nil # can be defined by the provider, use "--set mysql.mysql.userPassword generateme"
    defaultDatabase: akeneo_pim
    dataDiskSize: 100Gi
    stateful:
      enabled: false
  common:
    class: ssd-retain

elasticsearch:
  appVersion: 5.6.14
  image:
    repository: docker.elastic.co/elasticsearch/elasticsearch
    tag: 5.6.14
  fullnameOverride: elasticsearch
  cluster:
    name: "pim-es"
    env:
      # See chart config map: https://github.com/helm/charts/blob/master/stable/elasticsearch/templates/configmap.yaml
      # And elasticsearch documentation: https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-gateway.html
      MINIMUM_MASTER_NODES: "2" # Might be equal to "lower((master.replicas/2)+1)
      EXPECTED_MASTER_NODES: "2" # Equals to MINIMUM_MASTER_NODES
      RECOVER_AFTER_MASTER_NODES: "2" # Equals to MINIMUM_MASTER_NODES
      EXPECTED_DATA_NODES: "2" # Equals to data.replica
      RECOVER_AFTER_DATA_NODES: "2" # Equals to data.replica
  client:
    replicas: 1
    heapSize: "128m"
    # # https://github.com/helm/charts/pull/9910/files
    # serviceAnnotations:
    #   service.alpha.kubernetes.io/tolerate-unready-endpoints: "true"
    resources:
      limits:
        cpu: "1"
        memory: "512Mi" # [ES 5.x] Minimum limits to 512Mi / [ES 6.x] Will work with limits to 320Mi
      requests:
        cpu: "25m"
        memory: "160Mi"
  master:
    replicas: 2
    persistence:
      size: 1Gi
      storageClass: ssd-retain
    heapSize: "256m"
    resources:
      limits:
        cpu: "1"
        memory: "512Mi"
      requests:
        cpu: "25m"
        memory: "320Mi"
  data:
    replicas: 2
    persistence:
      size: 10Gi
      storageClass: ssd-retain
    heapSize: "256m"
    resources:
      limits:
        cpu: "1"
        memory: "1024Mi"
      requests:
        cpu: "25m"
        memory: "512Mi"

catalog:
  EE:
    minimal:
      path: vendor/akeneo/pim-enterprise-dev/src/PimEnterprise/Bundle/InstallerBundle/Resources/fixtures/minimal
      class: PimEnterpriseInstallerBundle:minimal
    icecat:
      path: vendor/akeneo/pim-enterprise-dev/src/PimEnterprise/Bundle/InstallerBundle/Resources/fixtures/icecat_demo_dev
      class: PimEnterpriseInstallerBundle:icecat_demo_dev
    onboarder:
      path: vendor/akeneo/pim-onboarder/src/Bundle/Resources/fixtures/onboarder
      class: PimOnboarderBundle:onboarder
