import {Meta, Story, ArgsTable, Canvas} from '@storybook/addon-docs';
import {BlockButton} from './BlockButton';
import {PlusIcon} from '../../icons';
import {Dropdown, Block} from '../../components';
import {useBooleanState} from '../../hooks';
import {useState} from 'react';
import {SpaceContainer} from '../../storybook';

<Meta
  title="Components/Buttons/BlockButton"
  component={BlockButton}
  argTypes={{
    disabled: {control: {type: 'boolean'}},
    onClick: {action: 'Clicked'},
    children: {control: {type: 'text'}},
  }}
  args={{
    children: 'Add block',
  }}
/>

# BlockButton

## Usage

BlockButtons express what action will occur when the users clicks. BlockButtons are used to initialize an action, either in the background or foreground of an experience.

## Playground

Use this playground to test the BlockButton component

<Canvas>
  <Story name="Standard">
    {args => {
      return <BlockButton {...args} />;
    }}
  </Story>
</Canvas>

<ArgsTable story="Standard" />

## Disabled

<Canvas>
  <Story name="Disabled">
    {args => {
      return (
        <>
          <BlockButton {...args}>
            Default
          </BlockButton>
          <BlockButton {...args} disabled={true}>
            Disabled
          </BlockButton>
        </>
      );
    }}
  </Story>
</Canvas>

## With an Icon

<Canvas>
  <Story name="With an Icon">
    {args => {
      return (
        <>
          <BlockButton {...args}>
            <PlusIcon /> Before
          </BlockButton>
          <BlockButton {...args}>
            After <PlusIcon />
          </BlockButton>
        </>
      );
    }}
  </Story>
</Canvas>

## With Dropdown and Blocks

<Canvas>
  <Story name="With Dropdown and Blocks">
    {args => {
      const [blockValues, setBlockValues] = useState([]);
      const [isOpen, open, close] = useBooleanState(false);
      return (
        <SpaceContainer gap={10}>
            {blockValues.map(blockValue => (
                <Block key={blockValue} removable={true} onRemove={() => setBlockValues(blockValues.filter(current => current !== blockValue))}>
                    {blockValue}
                </Block>
            ))}
            <Dropdown>
                <BlockButton onClick={open} disabled={blockValues.length === 3}>
                    Add a block
                </BlockButton>
                {isOpen && (
                    <Dropdown.Overlay onClose={close} fullWidth={true}>
                        <Dropdown.Header>
                            <Dropdown.Title>Blocks</Dropdown.Title>
                        </Dropdown.Header>
                        <Dropdown.ItemCollection>
                            {['Block 1', 'Block 2', 'Block 3'].filter(blockValue => !blockValues.includes(blockValue)).map(option => (
                                <Dropdown.Item key={option} onClick={() => {setBlockValues(blockValues => [...blockValues, option]);close();}}>
                                    {option}
                                </Dropdown.Item>
                            ))}
                        </Dropdown.ItemCollection>
                    </Dropdown.Overlay>
                )}
            </Dropdown>
        </SpaceContainer>
      );
    }}
  </Story>
</Canvas>
