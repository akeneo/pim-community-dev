services:
    akeneo_authentication.sso.configuration.repository:
        class: 'Akeneo\Platform\Bundle\AuthenticationBundle\Sso\Configuration\Persistence\Sql\SqlRepository'
        arguments:
            - '@database_connection'

    akeneo_authentication.sso.configuration.create_or_update_handler:
        class: 'Akeneo\Platform\Component\Authentication\Sso\Configuration\CreateOrUpdateConfigurationHandler'
        arguments:
            - '@akeneo_authentication.sso.configuration.repository'

    akeneo_authentication.sso.configuration.ui.controller:
        class: 'Akeneo\Platform\Bundle\AuthenticationBundle\Sso\Configuration\UI\Controller'
        arguments:
            - '@validator'
            - '@pim_internal_api_serializer'
            - '@akeneo_authentication.sso.configuration.create_or_update_handler'
            - '@akeneo_authentication.sso.configuration.repository'

    akeneno_authentication.sso.configuration.ui.normalizer:
        class: 'Akeneo\Platform\Bundle\AuthenticationBundle\Sso\Configuration\UI\Normalizer'
        tags:
            - { name: pim_internal_api_serializer.normalizer }

    onelogin_auth:
        class: 'OneLogin\Saml2\Auth'
        factory: 'onelogin_auth.factory:create'

    onelogin_auth.factory:
        class: 'Akeneo\Platform\Bundle\AuthenticationBundle\Sso\OneLoginAuthFactory'
        arguments:
            - '@akeneo_authentication.sso.configuration.repository'
            - '%hslavich_onelogin_saml.settings%'

    akeneno_authentication.sso.firewall_map:
        class: 'Akeneo\Platform\Bundle\AuthenticationBundle\Sso\FirewallMap'
        decorates: 'security.firewall.map'
        decoration_inner_name: 'security.firewall.map.inner'
        arguments:
            - '@security.firewall.map.inner'
            - '@akeneo_authentication.sso.configuration.repository'
