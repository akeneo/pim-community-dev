{% extends 'PimEnrichBundle::layout.html.twig' %}
{% import 'PimDataGridBundle::macros.html.twig' as dataGrid %}

{% block head_script %}
    {{ parent() }}
    {% include 'PimEnterpriseProductAssetBundle:ProductAsset:_create-js-handler.html.twig' %}
    <script type="text/javascript">
        require(
            ['jquery', 'jquery.sidebarize'],
            function ($) {
                'use strict';
                $(function() {
                    $('.has-sidebar').sidebarize();
                });
            }
        );
    </script>
{% endblock %}

{% block content %}
    {% set title = 'pimee_product_asset.page_tab.title.index'|trans %}

    {% set buttons %}
        {% if resource_granted('pimee_product_asset_create') %}
            <a class="btn btn-primary pull-right create-asset" href="javascript:void(0);" title="{{ 'btn.create.asset'|trans|capitalize }}" data-form-url="{{ path('pimee_product_asset_create')}}">
                {{ 'btn.create.asset'|trans|capitalize }}
            </a>
        {% endif %}
    {% endset %}

    {{ elements.page_header(title, buttons) }}

    {% set categoriesGranted = true %}
    <div class="row-fluid {{ categoriesGranted ? 'has-sidebar': '' }}">
        {% if categoriesGranted %}
            <div id="tree" data-datalocale="{{ locale_code() }}" data-relatedentity="asset"></div>
        {% endif %}
        <div id="product-grid">
            {{ dataGrid.renderStatefulGrid('asset-grid', { dataLocale: locale_code(), currentUser: app.user }, {}, 'pimee_asset_categorytree') }}
        </div>
    </div>

{% endblock %}
