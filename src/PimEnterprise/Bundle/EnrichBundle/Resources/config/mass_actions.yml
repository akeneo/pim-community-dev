parameters:
    pimee_enrich.mass_edit_action.operator.published_product.class: PimEnterprise\Bundle\EnrichBundle\MassEditAction\Operator\PublishedProductMassEditOperator
    pimee_enrich.mass_edit_action.publish.class:                    PimEnterprise\Bundle\EnrichBundle\MassEditAction\Operation\Publish
    pimee_enrich.mass_edit_action.unpublish.class:                  PimEnterprise\Bundle\EnrichBundle\MassEditAction\Operation\Unpublish
    pim_enrich.mass_edit_action.edit_common_attributes.class:       PimEnterprise\Bundle\EnrichBundle\MassEditAction\Operation\EditCommonAttributes
    pim_enrich.mass_edit_action.classify.class:                     PimEnterprise\Bundle\EnrichBundle\MassEditAction\Operation\Classify

    pimee_enrich.mass_edit_handler.publish_product.class:           PimEnterprise\Bundle\EnrichBundle\MassEditAction\Handler\PublishProductHandler
    pimee_enrich.mass_edit_handler.unpublish_product.class:         PimEnterprise\Bundle\EnrichBundle\MassEditAction\Handler\UnpublishProductHandler
    pimee_enrich.mass_edit_handler.edit_common_attributes.class:    PimEnterprise\Bundle\EnrichBundle\MassEditAction\Handler\EditCommonAttributesHandler
    pimee_enrich.mass_edit_handler.add_product_value_with_permission.class: PimEnterprise\Bundle\EnrichBundle\MassEditAction\Handler\AddProductValueWithPermissionHandler

services:
    # Published products operation
    pimee_enrich.mass_edit_action.unpublish:
        public: false
        class: %pimee_enrich.mass_edit_action.unpublish.class%
        tags:
            -
                name: pim_enrich.mass_edit_action
                alias: unpublish
                acl: pimee_workflow_published_product_index
                datagrid: published-product-grid

    #Â New products operations
    pimee_enrich.mass_edit_action.publish:
        public: false
        class: %pimee_enrich.mass_edit_action.publish.class%
        tags:
            -
                name: pim_enrich.mass_edit_action
                alias: publish
                acl: pim_enrich_product_edit_attributes
                datagrid: product-grid

    # Overriden products operation to deal with product draft or working copy saving depending on permissions
    pim_enrich.mass_edit_action.edit_common_attributes:
        public: false
        class: %pim_enrich.mass_edit_action.edit_common_attributes.class%
        arguments:
            - '@pim_catalog.builder.product'
            - '@pim_user.context.user'
            - '@pim_catalog.context.catalog'
            - '@pim_catalog.repository.attribute'
            - '@pim_serializer'
            - '@pim_catalog.manager.media'
            - '@pim_catalog.manager.product_mass_action'
            - %upload_dir%
            - '@security.context'
        tags:
            -
                name: pim_enrich.mass_edit_action
                alias: edit-common-attributes
                acl: pim_enrich_product_edit_attributes
                datagrid: product-grid

    # Overriden products operation to add permission checks when try to classify products
    pim_enrich.mass_edit_action.classify:
        public: false
        class: %pim_enrich.mass_edit_action.classify.class%
        tags:
            -
                name: pim_enrich.mass_edit_action
                alias: classify
                acl: pim_enrich_product_categories_view
                datagrid: product-grid

    pim_enrich.mass_edit_handler.publish_product:
        class: %pimee_enrich.mass_edit_handler.publish_product.class%
        arguments:
            - '@pim_catalog.query.product_query_builder_factory'
            - '@pimee_workflow.manager.published_product'
            - '@pim_enrich.product.paginator'
            - '@pim_validator'
            - '@akeneo_storage_utils.doctrine.object_detacher'
            - '@oro_user.manager'
            - '@security.context'

    pim_enrich.mass_edit_handler.unpublish_product:
        class: %pimee_enrich.mass_edit_handler.unpublish_product.class%
        arguments:
            - '@pimee_workflow.doctrine.query.published_product_query_factory'
            - '@pimee_workflow.manager.published_product'
            - '@pim_enrich.product.paginator'
            - '@akeneo_storage_utils.doctrine.object_detacher'
            - '@oro_user.manager'
            - '@security.context'

    # Overriden mass edit handler to add permission checks
    pim_enrich.mass_edit_handler.edit_common_attributes:
        class: %pimee_enrich.mass_edit_handler.edit_common_attributes.class%
        arguments:
            - '@pim_catalog.query.product_query_builder_factory'
            - '@pim_catalog.updater.product'
            - '@pim_catalog.saver.product'
            - '@akeneo_storage_utils.doctrine.object_detacher'
            - '@pim_enrich.product.paginator'
            - '@pim_validator'
            - '@pim_catalog.repository.product_mass_action'
            - '@pim_catalog.repository.attribute'
            - '@oro_user.manager'
            - '@security.context'

    pimee_enrich.mass_edit_handler.add_product_value_with_permission:
        class: %pimee_enrich.mass_edit_handler.add_product_value_with_permission.class%
        arguments:
            - '@pim_catalog.query.product_query_builder_factory'
            - '@pim_catalog.updater.product'
            - '@pim_catalog.saver.product'
            - '@akeneo_storage_utils.doctrine.object_detacher'
            - '@pim_enrich.product.paginator'
            - '@pim_validator'
            - '@oro_user.manager'
            - '@security.context'
