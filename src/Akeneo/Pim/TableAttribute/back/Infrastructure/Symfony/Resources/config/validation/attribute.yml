Akeneo\Pim\Structure\Component\Model\Attribute:
    constraints:
        - Akeneo\Pim\TableAttribute\Infrastructure\Validation\Attribute\IsTableAttributeConfigured: ~
        - Akeneo\Pim\TableAttribute\Infrastructure\Validation\Attribute\FirstColumnCodeCannotBeChanged: ~
    properties:
        rawTableConfiguration:
            - Type: array
            - Count:
                  min: 2
                  minMessage: pim_table_configuration.validation.table_configuration.must_contain_at_least_two_columns
            - Akeneo\Pim\TableAttribute\Infrastructure\Validation\Attribute\IsColumnCodeUnique: ~
            - Akeneo\Pim\TableAttribute\Infrastructure\Validation\Attribute\FirstColumnShouldHaveSelectDataType: ~
            - All:
                  - Type: array
                  - Akeneo\Pim\TableAttribute\Infrastructure\Validation\Attribute\ValidationShouldMatchColumnType: ~
                  - Collection:
                        fields:
                            code:
                                - Required:
                                    - NotBlank:
                                          message: pim_table_configuration.validation.table_configuration.column_code_must_be_filled
                                    - Regex:
                                          pattern: /^[a-zA-Z0-9_]+$/
                                          message: pim_table_configuration.validation.table_configuration.invalid_code
                                    - Length:
                                          max: 100
                                          maxMessage: pim_table_configuration.validation.table_configuration.too_long_code
                            data_type:
                                - Required:
                                      - Type:
                                          type: string
                                          message: pim_table_configuration.validation.table_configuration.column_type_must_be_a_string
                                      - Choice:
                                          choices: ["text", "number", "boolean", "select"]
                                          message: pim_table_configuration.validation.table_configuration.unknown_data_type
                            labels:
                                - Optional:
                                    - Type:
                                          type: array
                                          message: pim_table_configuration.validation.table_configuration.invalid_labels_format
                                    - Akeneo\Pim\TableAttribute\Infrastructure\Validation\Attribute\LabelCollection: ~
                                    - All:
                                          - Type:
                                                type: string
                                                message: pim_table_configuration.validation.table_configuration.column_label_must_be_a_string
                                          - NotNull:
                                                message: pim_table_configuration.validation.table_configuration.column_label_must_be_a_string
                            validations:
                                - Optional:
                                      - Type:
                                            type: array
                                            message: TODO Validation should be an object
                                      - Collection:
                                          fields:
                                              max_length:
                                                  - Type:
                                                      type: int
                                                      message: TODO integer
                                                  - Positive:
                                                      message : TODO positive int
                                              min:
                                                  - Type:
                                                        type: int
                                                        message: TODO integer
                                                  - PositiveOrZero:
                                                        message: TODO positive integer
                                              max:
                                                  - Type:
                                                        type: int
                                                        message: TODO integer
                                                  - Positive:
                                                        message: TODO positive integer
                                              decimals_allowed:
                                                  - Type:
                                                        type: bool
                                                        message: TODO bool

                                          allowMissingFields: true
                                          allowExtraFields: true # handled in ValidationShouldMatchColumnType
                                      - Akeneo\Pim\TableAttribute\Infrastructure\Validation\Attribute\MaxShouldBeGreaterThanMin: ~
                        missingFieldsMessage: pim_table_configuration.validation.table_configuration.missing_column
