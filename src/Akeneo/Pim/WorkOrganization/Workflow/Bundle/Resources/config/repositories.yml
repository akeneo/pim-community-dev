parameters:
    pimee_workflow.repository.entity_with_values_draft.class:       Akeneo\Pim\WorkOrganization\Workflow\Bundle\Doctrine\ORM\Repository\EntityWithValuesDraftRepository
    pimee_workflow.repository.published_product.class: Akeneo\Pim\WorkOrganization\Workflow\Bundle\Doctrine\ORM\Repository\PublishedProductRepository
    pimee_workflow.repository.published_product_with_permission.class: Akeneo\Pim\WorkOrganization\Workflow\Bundle\Doctrine\ORM\Repository\PublishedProductWithPermissionRepository
    pimee_workflow.repository.published_association.class: Akeneo\Pim\WorkOrganization\Workflow\Bundle\Doctrine\ORM\Repository\PublishedAssociationRepository
    pimee_workflow.repository.delegating_product.class: Akeneo\Pim\WorkOrganization\Workflow\Bundle\Doctrine\ORM\Repository\DelegatingProductRepository

services:
    pimee_workflow.object_manager.product_draft:
        alias: doctrine.orm.entity_manager

    pimee_workflow.object_manager.product_model_draft:
        alias: doctrine.orm.entity_manager

    pimee_workflow.repository.published_product:
        class: '%pimee_workflow.repository.published_product.class%'
        factory: ['@pim_catalog.object_manager.product', 'getRepository']
        arguments: ['%pimee_workflow.entity.published_product.class%']
        tags:
            - { name: 'pim_repository' }

    pimee_workflow.repository.published_product_with_permission:
        class: '%pimee_workflow.repository.published_product_with_permission.class%'
        decorates: pimee_workflow.repository.published_product
        decoration_inner_name: pimee_workflow.repository.published_product_without_permission
        arguments:
            - '@pim_catalog.object_manager.product'
            - '@pimee_workflow.repository.published_product_without_permission'
            - '@pimee_workflow.security.factory.filtered_published_product'
            - '@pimee_security.deny_not_granted_categorized_entity'
            - '%pimee_workflow.entity.published_product.class%'

    pimee_workflow.repository.published_product_category:
        class: '%pim_catalog.repository.product_category.class%'
        arguments:
            - '@pim_catalog.object_manager.product'
            - '%pimee_workflow.entity.published_product.class%'
            - '%pim_catalog.entity.category.class%'

    pimee_workflow.repository.published_association:
        class: '%pimee_workflow.repository.published_association.class%'
        factory: ['@doctrine.orm.default_entity_manager', 'getRepository']
        arguments:
            - '%pimee_workflow.entity.published_product_association.class%'
        tags:
            - { name: 'pim_repository' }

    pimee_workflow.repository.product_draft:
        class: '%pimee_workflow.repository.entity_with_values_draft.class%'
        factory: ['@pimee_workflow.object_manager.product_draft', 'getRepository']
        arguments: ['%pimee_workflow.model.product_draft.class%']
        tags:
            - { name: 'pim_repository' }

    pimee_workflow.repository.product_model_draft:
        class: '%pimee_workflow.repository.entity_with_values_draft.class%'
        factory: ['@doctrine.orm.default_entity_manager', 'getRepository']
        arguments: ['%pimee_workflow.model.product_model_draft.class%']
        tags:
            - { name: 'pim_repository' }

    pimee_workflow.repository.delegating_product:
        class: '%pimee_workflow.repository.delegating_product.class%'
        arguments:
            - '@security.token_storage'
            - '@security.authorization_checker'
            - '@pim_catalog.repository.product'
            - '@pimee_workflow.repository.product_draft'
            - '@pimee_workflow.applier.draft'

    pimee_workflow.repository.delegating_product_model:
        class: '%pimee_workflow.repository.delegating_product.class%'
        arguments:
            - '@security.token_storage'
            - '@security.authorization_checker'
            - '@pim_catalog.repository.product_model'
            - '@pimee_workflow.repository.product_model_draft'
            - '@pimee_workflow.applier.draft'

    pimee_workflow.repository.proposal_tracking:
        class: Akeneo\Pim\WorkOrganization\Workflow\Bundle\Doctrine\ORM\Repository\ProposalTrackingRepository
        arguments:
            - '@database_connection'
