parameters:
    pimee_workflow.repository.product_draft.class:       PimEnterprise\Bundle\WorkflowBundle\Doctrine\ORM\Repository\ProductDraftRepository
    pimee_workflow.repository.published_product.class: PimEnterprise\Bundle\WorkflowBundle\Doctrine\ORM\Repository\PublishedProductRepository
    pimee_workflow.repository.published_association.class: PimEnterprise\Bundle\WorkflowBundle\Doctrine\ORM\Repository\PublishedAssociationRepository

    pimee_workflow.subscriber.product_draft.exclude_deleted_attribute.class: PimEnterprise\Bundle\WorkflowBundle\EventSubscriber\ProductDraft\ORM\ExcludeDeletedAttributeSubscriber

services:
    pimee_workflow.object_manager.product_draft:
        alias: doctrine.orm.entity_manager

    pimee_workflow.repository.published_product:
        class: %pimee_workflow.repository.published_product.class%
        factory_service: pim_catalog.object_manager.product
        factory_method: getRepository
        arguments: [%pimee_workflow.entity.published_product.class%]
        calls:
            - [setProductQueryBuilderFactory, ['@pimee_workflow.doctrine.query.published_product_query_factory']]
            - [setAttributeRepository, ['@pim_catalog.repository.attribute']]
        tags:
            - { name: 'pim_repository' }

    pimee_workflow.repository.published_product_category:
        class: %pim_catalog.repository.product_category.class%
        arguments:
            - '@pim_catalog.object_manager.product'
            - %pimee_workflow.entity.published_product.class%

    pimee_workflow.repository.published_association:
        class: %pimee_workflow.repository.published_association.class%
        factory_service: doctrine.orm.entity_manager
        factory_method: getRepository
        arguments:
            - %pimee_workflow.entity.published_product_association.class%
        tags:
            - { name: 'pim_repository' }

    pimee_workflow.repository.product_draft:
        class: %pimee_workflow.repository.product_draft.class%
        factory_service: pimee_workflow.object_manager.product_draft
        factory_method: getRepository
        arguments: [%pimee_workflow.model.product_draft.class%]
        tags:
            - { name: 'pim_repository' }

    pimee_workflow.repository.published_product_mass_action:
        class: %pim_catalog.repository.product_mass_action.class%
        arguments:
            - '@pim_catalog.object_manager.product'
            - %pimee_workflow.entity.published_product.class%
            - '@pimee_workflow.repository.published_product'

    pimee_workflow.subscriber.product_draft.exclude_deleted_attribute:
        class: %pimee_workflow.subscriber.product_draft.exclude_deleted_attribute.class%
        arguments:
            - '%pim_catalog.entity.attribute.class%'
        tags:
            - { name: doctrine.event_subscriber }
