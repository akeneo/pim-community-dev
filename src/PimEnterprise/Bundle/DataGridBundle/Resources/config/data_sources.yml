parameters:
    pimee_datagrid.datasource.product_history.class: Pim\Bundle\DataGridBundle\Datasource\Datasource
    pimee_datagrid.datasource.product_draft.class: Pim\Bundle\DataGridBundle\Datasource\Datasource
    pimee_datagrid.datasource.product_proposal.class: PimEnterprise\Bundle\DataGridBundle\Datasource\ProductProposalDatasource

services:
    pim_catalog.product_history.product:
        class: '%pim_datagrid.datasource.default.class%'
        arguments:
            - '@pim_catalog.object_manager.product'
            - '@pimee_datagrid.datasource.result_record.hydrator.product_history'
        tags:
            - { name: oro_datagrid.datasource, type: pimee_datasource_product_history }

    pim_catalog.datasource.published_product:
        class: '%pim_datagrid.datasource.product.class%'
        arguments:
            - '@pim_catalog.object_manager.product'
            - '@pimee_workflow.doctrine.query.published_product_query_builder_from_size_factory'
            - '@pim_datagrid.normalizer.product'
            - '@pim_datagrid.event_subscriber.filter_entity_with_values_subscriber'
        calls:
            - [ setMassActionRepository, ['@pimee_workflow.repository.published_product_mass_action' ]]
        tags:
            - { name: oro_datagrid.datasource, type: pimee_datasource_published_product }

    pimee_catalog.datasource.product_draft:
        class: '%pimee_datagrid.datasource.product_draft.class%'
        arguments:
            - '@pim_catalog.object_manager.product'
            - '@pim_datagrid.datasource.result_record.hydrator.product_draft'
        tags:
            - { name: oro_datagrid.datasource, type: pimee_datasource_product_draft }

    pim_datagrid.datasource.rule:
        class: '%pim_datagrid.datasource.default.class%'
        arguments:
            - '@doctrine.orm.entity_manager'
            - '@pim_datagrid.datasource.result_record.hydrator.default'
        calls:
            - [ setMassActionRepository, ['@pimee_catalog_rule.repository.rule_definition_mass_action' ]]
        tags:
            - { name: oro_datagrid.datasource, type: pim_datasource_rule }

    pim_catalog.datasource.proposal_product:
        class: '%pimee_datagrid.datasource.product_proposal.class%'
        arguments:
            - '@pimee_workflow.doctrine.query.proposal_product_and_product_model_query_builder_from_size_factory_with_permissions'
            - '@pim_serializer'
        calls:
            - [ setMassActionRepository, ['@pimee_workflow.repository.product_draft' ]]
        tags:
            - { name: oro_datagrid.datasource, type: pimee_datasource_proposal_product }

    pim_datagrid.datasource.adapter_resolver:
        class: '%pim_datagrid.datasource.adapter_resolver.class%'
        arguments:
            - '%pim_filter.datasource.orm_adapter.class%'
            - '%pim_filter.datasource.product_orm_adapter.class%'
        calls:
            - [addProductDatasource, ['pim_datasource_product']]
            - [addProductDatasource, ['pim_datasource_associated_product']]
            - [addProductDatasource, ['pim_datasource_associated_product_model']]
            - [addProductDatasource, ['pimee_datasource_published_product']]
            - [addProductDatasource, ['pim_datasource_group_product']]
            - [addProductDatasource, ['pimee_datasource_proposal_product']]
