parameters:
    pim_config.event_listener.user_preferences.class:  Pim\Bundle\ConfigBundle\EventListener\UserPreferencesListener

services:
    #Â Subscriber
    pim_config.event_listener.user_preferences:
        class: %pim_config.event_listener.user_preferences.class%
        calls:
            - [ setContainer, [ @service_container ] ]
        tags:
            - { name: doctrine.event_subscriber }

    # Validators
    pim_config.validator.valid_locale_fallback:
        class: Pim\Bundle\ConfigBundle\Validator\Constraints\ValidLocaleFallbackValidator
        arguments:
            - @doctrine.orm.entity_manager
        tags:
            - { name: validator.constraint_validator, alias: pim_config.validator.valid_locale_fallback_validator }

    # Locale helper
    pim_config.helper.locale:
        class: Pim\Bundle\ConfigBundle\Helper\LocaleHelper
        arguments:
            - @pim_config.manager.locale
            
    # Twig extension
    pim_config.twig.locale_extension:
        class: Pim\Bundle\ConfigBundle\Twig\LocaleExtension
        arguments:
            - @pim_config.helper.locale
        tags:
            - { name: twig.extension }
