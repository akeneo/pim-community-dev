parameters:
    pimee_activity_manager.table_name_mapper.class: 'PimEnterprise\Bundle\ActivityManagerBundle\Doctrine\ORM\TableNameMapper'
    pimee_activity_manager.repository.user.class: 'PimEnterprise\Bundle\ActivityManagerBundle\Doctrine\ORM\Repository\UserRepository'
    pimee_activity_manager.repository.product.class: 'PimEnterprise\Bundle\ActivityManagerBundle\Doctrine\ORM\Repository\ProductRepository'
    pimee_activity_manager.repository.family_requirement.class: 'PimEnterprise\Bundle\ActivityManagerBundle\Doctrine\ORM\Repository\FamilyRequirementRepository'
    pimee_activity_manager.repository.attribute_permission.class: 'PimEnterprise\Bundle\ActivityManagerBundle\Doctrine\ORM\Repository\AttributePermissionRepository'
    pimee_activity_manager.repository.pre_processing.class: 'PimEnterprise\Bundle\ActivityManagerBundle\Doctrine\ORM\Repository\PreProcessingRepository'
    pimee_activity_manager.repository.notification_history.class: 'PimEnterprise\Bundle\ActivityManagerBundle\Doctrine\ORM\Repository\NotificationHistoryRepository'
    pimee_activity_manager.factory.project_calculation_notification.class: 'PimEnterprise\Bundle\ActivityManagerBundle\Notification\ProjectCalculationNotificationFactory'
    pimee_activity_manager.factory.project_created_notification.class: 'PimEnterprise\Bundle\ActivityManagerBundle\Notification\ProjectCreatedNotificationFactory'
    pimee_activity_manager.factory.project_finished_notification.class: 'PimEnterprise\Bundle\ActivityManagerBundle\Notification\ProjectFinishedNotificationFactory'
    pimee_activity_manager.event_subscriber.project_creation_notifier.class: 'PimEnterprise\Bundle\ActivityManagerBundle\EventListener\ProjectCreationNotifierSubscriber'
    pimee_activity_manager.event_subscriber.project_finished_notifier.class: 'PimEnterprise\Bundle\ActivityManagerBundle\EventListener\ProjectFinishedNotifierSubscriber'
    pimee_activity_manager.event_subscriber.catalog_updates.class: 'PimEnterprise\Bundle\ActivityManagerBundle\EventListener\CatalogUpdatesSubscriber'
    pimee_activity_manager.converter.filter.class: 'PimEnterprise\Bundle\ActivityManagerBundle\Datagrid\FilterConverter'

services:
    pimee_activity_manager.table_name_mapper:
        class: '%pimee_activity_manager.table_name_mapper.class%'
        arguments:
            - '@akeneo_storage_utils.doctrine.table_name_builder'
            - '%pimee_activity_manager.pre_processing.tables%'

    ### Repositories
    pimee_activity_manager.repository.user:
        class: '%pimee_activity_manager.repository.user.class%'
        arguments:
            - '@doctrine.orm.default_entity_manager'
            - '%pim_user.entity.user.class%'

    pimee_activity_manager.repository.product:
        class: '%pimee_activity_manager.repository.product.class%'
        arguments:
            - '@pim_catalog.query.product_query_builder_factory'
            - '@pimee_security.repository.category_access'

    pimee_activity_manager.repository.family_requirement:
        class: '%pimee_activity_manager.repository.family_requirement.class%'
        arguments:
            - '@doctrine.orm.default_entity_manager'
            - '%pim_catalog.entity.attribute_requirement.class%'

    pimee_activity_manager.repository.attribute_permission:
        class: '%pimee_activity_manager.repository.attribute_permission.class%'
        arguments:
            - '@doctrine.orm.default_entity_manager'
            - '%pimee_security.entity.attribute_group_access.class%'

    pimee_activity_manager.repository.pre_processing:
        class: '%pimee_activity_manager.repository.pre_processing.class%'
        arguments:
            - '@doctrine.orm.default_entity_manager'
            - '@pimee_activity_manager.table_name_mapper'

    pimee_activity_manager.repository.notification_history:
        class: '%pimee_activity_manager.repository.notification_history.class%'
        arguments:
            - '@doctrine.orm.default_entity_manager'
            - '%pimee_activity_manager.model.notification_history.class%'

    ### Notifications
    pimee_activity_manager.factory.project_calculation_notification:
        class: '%pimee_activity_manager.factory.project_calculation_notification.class%'
        arguments:
            - ['project_calculation']
            - '%pim_notification.entity.notification.class%'
        public: false
        tags:
            - { name: pim_notification.factory.notification }

    pimee_activity_manager.factory.project_created_notification:
        class: '%pimee_activity_manager.factory.project_created_notification.class%'
        arguments:
            - '%pim_notification.entity.notification.class%'

    pimee_activity_manager.factory.project_finished_notification:
        class: '%pimee_activity_manager.factory.project_finished_notification.class%'
        arguments:
            - '%pim_notification.entity.notification.class%'

    pimee_activity_manager.event_subscriber.project_creation_notifier:
        class: '%pimee_activity_manager.event_subscriber.project_creation_notifier.class%'
        arguments:
            - '@pimee_activity_manager.factory.project_created_notification'
            - '@pim_notification.notifier'
            - '@pimee_activity_manager.repository.user'
            - '@pim_catalog.localization.presenter.date'
            - '@pimee_activity_manager.repository.project_completeness'
            - '@pimee_activity_manager.repository.notification_history'
            - '@pimee_activity_manager.saver.notification_history'
            - '@pimee_activity_manager.factory.notification_history'
        tags:
            - { name: kernel.event_subscriber }

    pimee_activity_manager.event_subscriber.project_finished_notifier:
        class: '%pimee_activity_manager.event_subscriber.project_finished_notifier.class%'
        arguments:
            - '@pimee_activity_manager.factory.project_finished_notification'
            - '@pim_notification.notifier'
            - '@pimee_activity_manager.repository.user'
            - '@pim_catalog.localization.presenter.date'
            - '@pimee_activity_manager.repository.project_completeness'
            - '@pimee_activity_manager.repository.notification_history'
            - '@pimee_activity_manager.saver.notification_history'
            - '@pimee_activity_manager.factory.notification_history'
        tags:
            - { name: kernel.event_subscriber }

    pimee_activity_manager.event_subscriber.catalog_updates:
        class: '%pimee_activity_manager.event_subscriber.catalog_updates.class%'
        arguments:
            - '@pimee_activity_manager.project_remover.chained'
        tags:
            - { name: kernel.event_subscriber }

    ### Datagrid
    pimee_activity_manager.converter.filter:
        class: '%pimee_activity_manager.converter.filter.class%'
        arguments:
            - '@pim_datagrid.adapter.oro_to_pim_grid_filter'
