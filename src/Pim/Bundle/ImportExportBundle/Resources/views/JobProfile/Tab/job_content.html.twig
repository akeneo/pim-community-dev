<div id="{{ viewElement.alias|replace({' ': '-', '.': '-'})|lower }}" class="tab-pane buffer-top">
    <div id="pim-product-export-edit-content"></div>
    <input id="{{ form.configuration.filters.vars.id }}" value="{{ form.configuration.filters.vars.value }}" type="hidden"/>
    <script>
        require(
            ['jquery', 'pim/fetcher-registry', 'pim/form-builder', 'oro/loading-mask'],
            function($, FetcherRegistry, FormBuilder, LoadingMask) {
                $(function() {
                    var loadingMask = new LoadingMask();
                    loadingMask.render().$el.appendTo($('#container')).show();
                    FetcherRegistry.initialize().done(function () {
                        FormBuilder.build('pim-product-export-edit-content')
                            .then(function (form) {
                                form
                                    .setElement('#pim-product-export-edit-content')
                                    .setData(JSON.parse($('#{{ form.configuration.filters.vars.id }}').val()), {silent: true})
                                    .render();

                                form.on('pim_enrich:form:entity:post_update', function () {
                                    document.getElementById('{{ form.configuration.filters.vars.id }}').value = JSON.stringify(form.getFormData());
                                });

                                loadingMask.remove();
                            });
                    })
                });
            });
    </script>
</div>
